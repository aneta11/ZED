---
title: "Projekt z analizy danych"
author: "Aneta Szczepaniak"
date: "12 listopada 2018"
output: 
  html_document: 
    keep_md: yes
    toc: yes
---

#Podsumowanie przeprowadzonej analizy
Raport zawiera analizę danych krystalograficznych wraz z oceną możliwości wykorzystania uczenia maszynowego do predykcji jakie cząsteczki mogą się kryć w niewymodelowanych fragmentach map intensywności. Dane wykorzystane do przeprowadzenia analizy pochodzą z Protein Data Bank. W zbiorze danych zawarte zostały szczegółowe informacje dotyczące ligandów. 

Ze względu na duży rozmiar zbioru danych analiza korelacji pomiędzy zmiennymi była utrudniona i wymagała podziału kolumn na podzbiory. Również tworzenie regresora i klasyfikatora wiązało się z pewnymi trudnościami. Ze względu na ograniczenia sprzętowe i czasowe możliwe było korzystanie jedynie z niskich parametrów wejściowych mających istotny wpływ na jakoś predykcji. 

W związku z tym przy próbie predykcji liczby atomów i elektronów lub wartości res_name, wykorzystującej kolumny silnie skorelowane (oparte o dane słownikowe oraz dane zamodelowane w pliku PDB) otrzymane rezultaty były bardzo dobre. Jednak przy próbie opartej o kolumny, których wartości obliczone zostały tylko na podstawie ligandu oraz te, których wartości są obliczone zostały na podstawie całego pliku PDB, uzyskana trafność regresji i klasyfikacji była niezadowalająca. 

Niewątpliwie brak wiedziy z zakresu krystalografii znacznie utrudnił analizę danych. Z pewnością posiadając szerszą wiedzię dziedzinową możliwe byłoby wyciągnięcie większej ilości wniosków. 



#Przygotowanie danych

##Wykorzystane biblioteki.
W procesie analizy wykorzystane zostały następujące biblioteki:

```r
library(knitr)
library(dplyr)
library(data.table)
library(DT)
library(ggplot2)
library(plotly)
library(tidyr)
library(reshape2)
library(corrplot)
library(caret)
library(utils)
library(randomForest)
library(e1071)
library(infotheo)
```

##Zapewnienie powtarzalności wyników
Aby zapewnić powtarzalność wyników przy każdym uruchomieniu raportu na tych samych danych ustawiona została wartość seed. 

```r
set.seed(23)
```

##Wczytanie danych z pliku
Dane o ligandach zostały unieszczone w pliku "all_summary.csv". Do ich wczytania wykorzystana została funkcja read.table. Ze względu na duży rozmiar pliku wejściowego konieczne było ustawienie parametru colClasses, aby przyspieszyć etap wczytywania danych. W tym celu najpierw została wczytana niewielka próbka danych z pliku (50000 wierszy). Na ich podstaie zostały określone typy poszczególnych kolumn. Dodatkowo utawiony został parametr nrows aby poprawić zarządzanie pamięcią.


##Filtracja danych na podstawie wartości zmiennej res_name
Ze zbioru zostają usunięte wiersze posiadające w kolumnie res_name wartość równą: “UNK”, “UNX”, “UNL”, “DUM”, “N”, “BLOB”, “ALA”, “ARG”, “ASN”, “ASP”, “CYS”, “GLN”, “GLU”, “GLY”, “HIS”, “ILE”, “LEU”, “LYS”, “MET”, “MSE”, “PHE”, “PRO”, “SEC”, “SER”, “THR”, “TRP”, “TYR”, “VAL”, “DA”, “DG”, “DT”, “DC”, “DU”, “A”, “G”, “T”, “C”, “U”, “HOH”, “H20”, “WAT”. Ponadto zostają jednocześnie usunięte wiersze posiadające wartość pustą w zmiennej res_name.


##Przetwarzanie brakujących danych
Ze zbioru danych zostaje wyrzuconych 11 kolumn zawierających same wartości puste bądź identyczne wartości w całej kolumnie nie wnosząc tym samym żadnej istotnej informacji do dalszej analizy. Usunięte w ten sposób kolumny to: local_min fo_col,  fc_col weight_col, grid_space, solvent_radius, solvent_opening_radius, resolution_max_limit, part_step_FoFc_std_min, part_step_FoFc_std_max, part_step_FoFc_std_step.


##Ograniczenie liczby klas (res_name)
Do dalszej analizy wykorzystane zostanie jedynie 50 najpopularniejszych wartości res_name. Reszta zostaje usunięta ze zbioru.


##Sekcję podsumowującą rozmiar zbioru i podstawowe statystyki.
Zbiór składa się z 381046 obserwacji oraz 401 atrybutów. Poniżej przedstawione zostały podstawowe statystyki.
<!--html_preserve--><div id="htmlwidget-933954b5d16cf6fad7ff" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-933954b5d16cf6fad7ff">{"x":{"filter":"none","data":[["blob_volume_coverage","blob_volume_coverage_second","res_volume_coverage","res_volume_coverage_second","local_res_atom_count","local_res_atom_non_h_count","local_res_atom_non_h_occupancy_sum","local_res_atom_non_h_electron_sum","local_res_atom_non_h_electron_occupancy_sum","local_res_atom_C_count","local_res_atom_N_count","local_res_atom_O_count","local_res_atom_S_count","dict_atom_non_h_count","dict_atom_non_h_electron_sum","dict_atom_C_count","dict_atom_N_count","dict_atom_O_count","dict_atom_S_count","skeleton_cycle_4","skeleton_diameter","skeleton_cycle_6","skeleton_cycle_7","skeleton_closeness_006_008","skeleton_closeness_002_004","skeleton_cycle_3","skeleton_avg_degree","skeleton_closeness_004_006","skeleton_closeness_010_012","skeleton_closeness_012_014","skeleton_edges","skeleton_radius","skeleton_cycle_8_plus","skeleton_closeness_020_030","skeleton_deg_5_plus","skeleton_closeness_016_018","skeleton_closeness_008_010","skeleton_closeness_018_020","skeleton_average_clustering","skeleton_closeness_040_050","skeleton_closeness_014_016","skeleton_center","skeleton_closeness_000_002","skeleton_density","skeleton_closeness_030_040","skeleton_deg_4","skeleton_deg_0","skeleton_deg_1","skeleton_deg_2","skeleton_deg_3","skeleton_graph_clique_number","skeleton_nodes","skeleton_cycles","skeleton_cycle_5","skeleton_closeness_050_plus","skeleton_periphery","local_volume","local_electrons","local_mean","local_std","local_max","local_max_over_std","local_skewness","local_cut_by_mainchain_volume","local_near_cut_count_C","local_near_cut_count_other","local_near_cut_count_S","local_near_cut_count_O","local_near_cut_count_N","part_00_shape_segments_count","part_00_density_segments_count","part_00_volume","part_00_electrons","part_00_mean","part_00_std","part_00_max","part_00_max_over_std","part_00_skewness","part_00_parts","part_00_shape_O3","part_00_shape_O4","part_00_shape_O5","part_00_shape_FL","part_00_shape_O3_norm","part_00_shape_O4_norm","part_00_shape_O5_norm","part_00_shape_FL_norm","part_00_shape_I1","part_00_shape_I2","part_00_shape_I3","part_00_shape_I4","part_00_shape_I5","part_00_shape_I6","part_00_shape_I1_norm","part_00_shape_I2_norm","part_00_shape_I3_norm","part_00_shape_I4_norm","part_00_shape_I5_norm","part_00_shape_I6_norm","part_00_shape_M000","part_00_shape_CI","part_00_shape_E3_E1","part_00_shape_E2_E1","part_00_shape_E3_E2","part_00_shape_sqrt_E1","part_00_shape_sqrt_E2","part_00_shape_sqrt_E3","part_00_density_O3","part_00_density_O4","part_00_density_O5","part_00_density_FL","part_00_density_O3_norm","part_00_density_O4_norm","part_00_density_O5_norm","part_00_density_FL_norm","part_00_density_I1","part_00_density_I2","part_00_density_I3","part_00_density_I4","part_00_density_I5","part_00_density_I6","part_00_density_I1_norm","part_00_density_I2_norm","part_00_density_I3_norm","part_00_density_I4_norm","part_00_density_I5_norm","part_00_density_I6_norm","part_00_density_M000","part_00_density_CI","part_00_density_E3_E1","part_00_density_E2_E1","part_00_density_E3_E2","part_00_density_sqrt_E1","part_00_density_sqrt_E2","part_00_density_sqrt_E3","part_00_shape_Z_7_3","part_00_shape_Z_0_0","part_00_shape_Z_7_0","part_00_shape_Z_7_1","part_00_shape_Z_3_0","part_00_shape_Z_5_2","part_00_shape_Z_6_1","part_00_shape_Z_3_1","part_00_shape_Z_6_0","part_00_shape_Z_2_1","part_00_shape_Z_6_3","part_00_shape_Z_2_0","part_00_shape_Z_6_2","part_00_shape_Z_5_0","part_00_shape_Z_5_1","part_00_shape_Z_4_2","part_00_shape_Z_1_0","part_00_shape_Z_4_1","part_00_shape_Z_7_2","part_00_shape_Z_4_0","part_00_density_Z_7_3","part_00_density_Z_0_0","part_00_density_Z_7_0","part_00_density_Z_7_1","part_00_density_Z_3_0","part_00_density_Z_5_2","part_00_density_Z_6_1","part_00_density_Z_3_1","part_00_density_Z_6_0","part_00_density_Z_2_1","part_00_density_Z_6_3","part_00_density_Z_2_0","part_00_density_Z_6_2","part_00_density_Z_5_0","part_00_density_Z_5_1","part_00_density_Z_4_2","part_00_density_Z_1_0","part_00_density_Z_4_1","part_00_density_Z_7_2","part_00_density_Z_4_0","part_01_shape_segments_count","part_01_density_segments_count","part_01_volume","part_01_electrons","part_01_mean","part_01_std","part_01_max","part_01_max_over_std","part_01_skewness","part_01_parts","part_01_shape_O3","part_01_shape_O4","part_01_shape_O5","part_01_shape_FL","part_01_shape_O3_norm","part_01_shape_O4_norm","part_01_shape_O5_norm","part_01_shape_FL_norm","part_01_shape_I1","part_01_shape_I2","part_01_shape_I3","part_01_shape_I4","part_01_shape_I5","part_01_shape_I6","part_01_shape_I1_norm","part_01_shape_I2_norm","part_01_shape_I3_norm","part_01_shape_I4_norm","part_01_shape_I5_norm","part_01_shape_I6_norm","part_01_shape_M000","part_01_shape_CI","part_01_shape_E3_E1","part_01_shape_E2_E1","part_01_shape_E3_E2","part_01_shape_sqrt_E1","part_01_shape_sqrt_E2","part_01_shape_sqrt_E3","part_01_density_O3","part_01_density_O4","part_01_density_O5","part_01_density_FL","part_01_density_O3_norm","part_01_density_O4_norm","part_01_density_O5_norm","part_01_density_FL_norm","part_01_density_I1","part_01_density_I2","part_01_density_I3","part_01_density_I4","part_01_density_I5","part_01_density_I6","part_01_density_I1_norm","part_01_density_I2_norm","part_01_density_I3_norm","part_01_density_I4_norm","part_01_density_I5_norm","part_01_density_I6_norm","part_01_density_M000","part_01_density_CI","part_01_density_E3_E1","part_01_density_E2_E1","part_01_density_E3_E2","part_01_density_sqrt_E1","part_01_density_sqrt_E2","part_01_density_sqrt_E3","part_01_shape_Z_7_3","part_01_shape_Z_0_0","part_01_shape_Z_7_0","part_01_shape_Z_7_1","part_01_shape_Z_3_0","part_01_shape_Z_5_2","part_01_shape_Z_6_1","part_01_shape_Z_3_1","part_01_shape_Z_6_0","part_01_shape_Z_2_1","part_01_shape_Z_6_3","part_01_shape_Z_2_0","part_01_shape_Z_6_2","part_01_shape_Z_5_0","part_01_shape_Z_5_1","part_01_shape_Z_4_2","part_01_shape_Z_1_0","part_01_shape_Z_4_1","part_01_shape_Z_7_2","part_01_shape_Z_4_0","part_01_density_Z_7_3","part_01_density_Z_0_0","part_01_density_Z_7_0","part_01_density_Z_7_1","part_01_density_Z_3_0","part_01_density_Z_5_2","part_01_density_Z_6_1","part_01_density_Z_3_1","part_01_density_Z_6_0","part_01_density_Z_2_1","part_01_density_Z_6_3","part_01_density_Z_2_0","part_01_density_Z_6_2","part_01_density_Z_5_0","part_01_density_Z_5_1","part_01_density_Z_4_2","part_01_density_Z_1_0","part_01_density_Z_4_1","part_01_density_Z_7_2","part_01_density_Z_4_0","part_02_shape_segments_count","part_02_density_segments_count","part_02_volume","part_02_electrons","part_02_mean","part_02_std","part_02_max","part_02_max_over_std","part_02_skewness","part_02_parts","part_02_shape_O3","part_02_shape_O4","part_02_shape_O5","part_02_shape_FL","part_02_shape_O3_norm","part_02_shape_O4_norm","part_02_shape_O5_norm","part_02_shape_FL_norm","part_02_shape_I1","part_02_shape_I2","part_02_shape_I3","part_02_shape_I4","part_02_shape_I5","part_02_shape_I6","part_02_shape_I1_norm","part_02_shape_I2_norm","part_02_shape_I3_norm","part_02_shape_I4_norm","part_02_shape_I5_norm","part_02_shape_I6_norm","part_02_shape_M000","part_02_shape_CI","part_02_shape_E3_E1","part_02_shape_E2_E1","part_02_shape_E3_E2","part_02_shape_sqrt_E1","part_02_shape_sqrt_E2","part_02_shape_sqrt_E3","part_02_density_O3","part_02_density_O4","part_02_density_O5","part_02_density_FL","part_02_density_O3_norm","part_02_density_O4_norm","part_02_density_O5_norm","part_02_density_FL_norm","part_02_density_I1","part_02_density_I2","part_02_density_I3","part_02_density_I4","part_02_density_I5","part_02_density_I6","part_02_density_I1_norm","part_02_density_I2_norm","part_02_density_I3_norm","part_02_density_I4_norm","part_02_density_I5_norm","part_02_density_I6_norm","part_02_density_M000","part_02_density_CI","part_02_density_E3_E1","part_02_density_E2_E1","part_02_density_E3_E2","part_02_density_sqrt_E1","part_02_density_sqrt_E2","part_02_density_sqrt_E3","part_02_shape_Z_7_3","part_02_shape_Z_0_0","part_02_shape_Z_7_0","part_02_shape_Z_7_1","part_02_shape_Z_3_0","part_02_shape_Z_5_2","part_02_shape_Z_6_1","part_02_shape_Z_3_1","part_02_shape_Z_6_0","part_02_shape_Z_2_1","part_02_shape_Z_6_3","part_02_shape_Z_2_0","part_02_shape_Z_6_2","part_02_shape_Z_5_0","part_02_shape_Z_5_1","part_02_shape_Z_4_2","part_02_shape_Z_1_0","part_02_shape_Z_4_1","part_02_shape_Z_7_2","part_02_shape_Z_4_0","part_02_density_Z_7_3","part_02_density_Z_0_0","part_02_density_Z_7_0","part_02_density_Z_7_1","part_02_density_Z_3_0","part_02_density_Z_5_2","part_02_density_Z_6_1","part_02_density_Z_3_1","part_02_density_Z_6_0","part_02_density_Z_2_1","part_02_density_Z_6_3","part_02_density_Z_2_0","part_02_density_Z_6_2","part_02_density_Z_5_0","part_02_density_Z_5_1","part_02_density_Z_4_2","part_02_density_Z_1_0","part_02_density_Z_4_1","part_02_density_Z_7_2","part_02_density_Z_4_0","resolution","FoFc_mean","FoFc_std","FoFc_square_std","FoFc_min","FoFc_max"],[0.02004008016,0,0.001883948757,0,1,1,0,6,0,0,0,0,0,1,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,49.248,0.01170493793,0.000114725,0.000660591,0.0045201,2.836182117,0.001174014706,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,121.3947368,3807.052632,33777.02632,75.70408004,0.2305739889,0.01760816859,0.0004262883158,1.168519378e-007,528.8201086,56939.7087,120944.7424,42.46570174,6.188604223,28626.17556,0.06322810516,0.001050860282,0.0008016258967,5.052252661e-008,1.433670721e-010,0.004862942323,38,-75.57044805,0.003026877205,0.00646652126,0.01144195139,1.188360445,0.738902385,0.5959134156,9.711224684,24.38308404,17.32080844,-3.009896981,0.03559376981,0.0004207922565,1.652895249e-006,-0.03476061339,42.2229442,363.0952973,775.2281353,-1.005383674,0.0962951793,182.7383907,0.001747813076,8.053167968e-007,6.251427124e-007,-0.01161094662,1.637856779e-010,2.090698844e-005,1.864285111,-92.07037372,0.003037992851,0.006444165149,0.01305281121,1.185639847,0.7382289477,0.5954518305,6.30312003,3.011948166,0.6818404009,3.773502276,0.6580642757,4.580256005,1.807757938,2.505837245,0.02436425529,2.749071954,4.113508963,1.322838224,2.941402487,0.8831405312,3.463939546,3.536957069,0.7968025334,2.131774803,5.955092907,0.02275509956,4.51583842,0.6671321355,0.9849014403,3.581875364,0.4221085286,3.42489029,0.4343871441,2.047835327,0.007071927991,0.7737221038,0.5448886683,0.5110995297,0.4772227986,0.980428404,2.393261783,0.5863015808,0.676804413,0.4739294732,4.379388061,0.007392273944,0,0,0,0,0,0,0,0,0,0,75.5625,1829,13344.78125,0,0.2273854245,0.0170131232,0.000385912931,0,215.5914307,11221.99972,11041.00587,0,0,5777.246138,0.06079878614,0.0009608418293,0.0007599305419,0,0,0.004634817215,32,-99.10585566,0.002686068554,0.004265184983,0.009098147053,0.9780705822,0.5280429429,0.3033367034,2.571448916,2.110861979,0.5480144926,-20.34378153,0.03547024376,0.0004179190428,1.636232857e-006,-0.006731947691,17.59328581,74.95620167,75.12815777,-4.945613055,0.004501116093,16.09444231,0.00173077621,7.899698444e-007,6.126378935e-007,-0.001879676035,6.213496432e-011,2.062968655e-005,0.4672307847,-116.1433213,0.002655719073,0.004245366816,0.00998371717,0.9755187403,0.5272160835,0.3032062157,6.019947729,2.763953196,0.7064404485,3.683437148,0.6282218944,4.437032395,0.7943246251,2.476404262,0.008393562113,1.712751415,3.452092318,0.05221444873,2.460815242,0.7731412737,2.692530518,2.234016479,0.7148603886,1.1381293,4.971272976,8.736893748e-008,5.049210488,0.3339807381,0.6196769627,3.423394411,0.552816826,3.651598015,0.1964239668,2.479874153,0.01066398104,0.3559485489,0.3605836562,0.05111619709,0.2664103766,0.7875961344,2.318934714,0.2698715196,0.6408007502,0.1951852739,3.960139477,0.005116128753,0,0,0,0,0,0,0,0,0,0,74.75,1808.75,12742.03125,-22.74415496,0.2269145962,0.01698600948,0.0003780413844,-1.917847392e-005,206.4160156,10875.0353,9699.994358,-7.683275699,0,5312.359985,0.06024977288,0.0009412415709,0.0007515553925,-6.478741585e-006,0,0.004609744519,32,-147.0097734,0.001997065472,0.003111094274,0.01024688429,0.9506794596,0.566878876,0.4024232911,9.46406785,28.34960848,24.27327256,-15.54668631,0.03293952489,0.0003613885822,1.320574892e-006,-0.004686326327,26.90263097,179.7692352,162.2540673,-5.770646085,0.0009484874835,88.32222845,0.001492929285,5.929662497e-007,4.480855128e-007,-0.001808171149,1.157187674e-010,1.642012403e-005,2.538354646,-156.9382304,0.001972135887,0.003099678034,0.009932988958,0.941989611,0.5650470083,0.4014297725,5.83960079,2.763953196,1.202296119,3.760529496,0.5630213071,3.978093159,1.078210511,2.673354808,0.002431445993,1.62046975,3.177852956,0.06102471242,2.169626771,0.7615551244,2.705489715,2.174361229,0.6729881274,0.8847612903,4.534117032,0.009469098667,4.990266676,0.7784520113,0.952241736,3.453036134,0.5339320117,3.786923886,0.4645438648,2.365648177,0.0005344082229,0.7793738898,0.9761576627,0.05072076666,0.7662380856,1.07067553,1.982171045,0.8687265538,0.6087433634,0.3994020304,4.240250682,0.006362781315,0.4800812304,-1.640728726e-007,0.001250090112,1.562725288e-006,-10.821105,0.007184891496],[0.441587656675,0,0.28134350555,0,1,1,1,28,25,0,0,0,0,1,28,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0.033812316925,0,0,0,2,0,0,2,2,0,0,0,2,200.448,3.33897222875,0.01245785,0.0695358,0.57023525,5.32110981775,0.12268087395,0,0,0,0,0,0,3,3,6.432,3.32238526125,0.368619220025,0.0659001586175,0.570235639775,5.32110981775,0.05737724672,1,23423.60543,140317156.35,236878133000,497083800.7,0.25828999355,0.02052796876,0.0004961788065,0.0003933159306,934197.08855,141409148300,306083531100,244505527.6,28962288.86,9444339706.5,0.08675282554,0.001651704572,0.002105234025,0.0001747120407,1.722814372e-005,0.0084743861165,804,-0.5391107797,0.1067721153,0.24402606425,0.4301198437,3.7805748975,2.535518234,1.956059719,11586.0136,34346923.26,28757763070,93018786.02,0.3318249448,0.032464425165,0.00093895145895,0.0010971664525,435089.8861,30966976740,65869898705,47584020.29,8562185.2885,2166590714.5,0.1608307979,0.0052465040315,0.0078395479445,0.0005298173987,7.5374012725e-005,0.02085743528,415.3087831,-0.5848329647,0.1037594367,0.2411222396,0.43375945065,3.5175745895,2.3909477765,1.86617858,14.35555418,13.85427231,6.3151649795,9.237992443,5.340269251,13.4446832,10.86340066,10.589233045,5.049093401,18.32086826,16.99718163,13.584880015,14.82280561,5.2620022645,10.366746265,17.35761647,1.312667325,14.16557806,12.16939334,7.3318555905,9.89744084,9.9572922325,5.854050754,7.2188457345,4.1167164385,9.2546296715,6.529464728,7.1378309505,3.227438143,13.75794909,10.67557123,10.67298505,9.287186869,4.9397560295,7.583137499,13.03045619,1.299548026,11.4478195,8.72819899,6.449487813,2,2,4.08,2.26161765175,0.40360109605,0.0537231007875,0.569705352225,5.32110981775,0.04524440645,1,11600.41603,33796193.16,27698390625,50793595.16,0.251449876,0.019734477355,0.0004775001864,0.00022998331305,338248.46625,18547353930,38087835345,23885502.4,2226207.0655,1682466709.5,0.080451623785,0.00146991176,0.0017180568225,0.00010006304775,7.8549924535e-006,0.0074988906975,522,-0.38787247685,0.10092343675,0.23752299985,0.4522811286,3.211389948,2.172781974,1.694644028,6415.87782,10141063.6,4525495105.5,12946883.85,0.3098519273,0.02857774947,0.00078946664295,0.000605074998,181744.56135,5325338005.5,10833357295,6321699.078,933126.3557,505804925.25,0.13639852135,0.0038591666365,0.005428009369,0.0002782182312,2.974484859e-005,0.01631578373,290.18049125,-0.4114294533,0.09900786215,0.23602658135,0.45686627075,3.017444925,2.07457019,1.635679055,11.410940905,11.16325761,6.42189693,8.207976779,4.3404330795,10.002988,8.3087758105,8.101250159,3.9216066755,14.32526853,12.75928089,10.34757987,11.020209145,5.2162686335,7.662200111,12.97419392,1.3757620165,10.196265875,9.8520036365,5.4103020195,9.031807217,8.3231898555,6.1031884745,7.273116029,3.9060004285,7.7604757935,5.3751457275,6.093539625,2.6317399205,11.357418425,8.3591898955,8.585891238,7.177858078,5.037362881,6.5007221295,9.654770726,1.361838535,8.0871958435,8.195805953,4.1404296445,1,1,2.376,1.39319674675,0.418510708025,0.04116212246,0.555362507725,5.32110981775,0.03328554912,1,6607.335702,10808016.405,5009398330.5,7643773.202,0.24655659195,0.01921401454,0.00046839795645,0.0001521112767,145532.5444,3576492098,6600465063,3459050.095,250071.66775,403851279.85,0.076171488,0.0013594634225,0.001468808259,6.5287189955e-005,4.1974030515e-006,0.006828237986,372,-0.2660722234,0.1025269498,0.2447787438,0.4823809785,2.783809387,1.9235640655,1.525839845,3948.4798015,3786729.845,1034089876.5,2651391.5205,0.28408611655,0.02438250726,0.00063489144735,0.0003343281157,86678.749985,1246517222,2363860147.5,1243784.314,150387.31315,146383438,0.11210039005,0.002671876909,0.0034966048855,0.0001490140526,1.273028043e-005,0.01210925975,222.9587055,-0.27480136715,0.10146078785,0.24493538155,0.48673097405,2.6427741405,1.855322954,1.4826396355,10.5565493,9.423823971,6.558028528,8.177132473,4.18521444,8.594977324,6.6092367465,6.7251652575,3.179077412,11.758963895,10.099747995,8.3019216465,8.6393371535,5.285582653,7.069118451,10.232288165,1.4358101055,8.101307462,9.4137940605,4.250623167,9.0866212595,7.295715875,6.334554275,7.473247559,3.9547413755,7.4156150095,4.655151675,5.613931596,2.2428670105,9.76063318,7.1395298655,7.201686162,6.0683818005,5.160740893,6.435185857,7.479178294,1.421653023,5.8440468775,8.3369600635,2.8766290795,1.79803913825,-4.92642966325e-011,0.09098303993,0.008277913556,-0.853695198925,1.187765241],[0.6988208695,0,0.50860693555,0,5,5,5,42,42,2,0,3,0,5,42,2,0,3,0,0,10,0,0,0,0,0,1.818181818,0,0,0,10,5,0,0,0,0,0,0,0,0,0,1,0,0.1176470588,0,0,0,2,8,0,2,11,0,0,3,2,297.6,6.6985595705,0.01906855,0.10033,0.899909,7.279117465,0.1776098909,0,2,0,0,1,1,15,15,12.128,6.6474701485,0.5240603945,0.1253716547,0.89990910885,7.279117465,0.1149028364,1,68863.77815,1219653854,6146806820000,13679915280,0.3294655247,0.02783966115,0.0006539893666,0.00302204429,4487780.523,3223982734000,7642562083000,7216620733,1700055709,135398536000,0.1661729164,0.004040930924,0.01179615372,0.001618623665,0.0004747521382,0.02517529835,1516,-3.45385705e-005,0.2212388733,0.4379409157,0.6242552963,5.156757841,3.272722427,2.505617004,34496.94721,302362095.7,743170487000,2961523207,0.5188579713,0.06923204723,0.002482166109,0.009155851872,2069549.137,691807509100,1591973954000,1673554010,528831609.5,31422707570,0.4142623967,0.02648760407,0.06865187542,0.005340587187,0.0020614561,0.09571150249,830.9391113,-4.223940431e-005,0.2267606887,0.4424322002,0.6306602578,4.804708887,3.047362655,2.351791076,22.77784583,19.02415151,8.420489953,14.79313558,9.175950951,21.7253091,17.29289626,16.26952123,8.625992825,25.87039879,26.29923948,19.70823667,23.29593874,9.787850718,17.84664128,27.03566552,1.452259729,23.11566643,19.75742193,12.70285324,16.39986198,14.08446309,6.955865503,11.5194747,6.679272636,15.46382149,14.13959008,11.07671295,6.582905377,19.60373604,19.68603723,15.56512814,18.05815819,8.055325293,13.18982475,20.72022075,1.441588217,18.47360052,14.7184264,11.35974708,9,9,8.848,5.3136205015,0.57407933535,0.1123264273,0.899838537,7.279117465,0.1003003632,1,41766.31111,445868858.2,1348340556000,3309977283,0.3069742591,0.02502671257,0.0005816093699,0.001874303078,2211282.616,770712070400,1792051781000,1741691416,314459917.2,40249946360,0.140160715,0.003016971915,0.0082100377,0.0009625746135,0.0002482278116,0.01945441082,1119,-4.835595802e-005,0.2451050098,0.4569346508,0.6471679429,4.509609441,2.931122609,2.272126934,23224.85822,135377033.6,223289475300,869978873.6,0.4766031412,0.06001245497,0.00206611919,0.004844607827,1178869.184,215650047800,497563269500,477493014.4,116680953.2,12106337920,0.339535043,0.0186243653,0.04349715569,0.002661951142,0.0008994599136,0.07014451218,672.3196734,-4.061131335e-005,0.2526590084,0.4614995237,0.6525201599,4.207939564,2.750274384,2.150486048,18.40845711,16.3444661,7.561351386,11.96619288,7.417876497,17.54859694,14.01116617,13.64629463,7.054674749,21.65126007,21.51741875,16.20755733,18.86575293,7.242119631,14.06645393,21.73879002,1.559668552,18.15384577,15.74663522,9.752697157,13.58884856,12.66903702,6.988652509,9.385580555,5.748122367,12.98176789,10.544503,9.740441829,4.932720996,17.28935774,15.83155754,13.50734101,14.2060925,6.592237115,10.81101654,17.49910301,1.552686058,15.36069963,11.97484439,9.052929296,5,5,6.352,4.144064015,0.6163034098,0.098922018175,0.89759773015,7.279117465,0.08593313915,1,27804.62828,194928525.2,390577362300,879488437,0.283690629,0.02259057563,0.0005260172729,0.0009605810872,1228007.651,236559085100,526300348800,446380574.5,57185537.18,14747577790,0.1132109493,0.002212901229,0.004836605171,0.0004606171835,9.072261616e-005,0.01381431284,874,-2.335051257e-005,0.2855921983,0.4907281092,0.6718240473,3.990816834,2.679502432,2.112788767,17017.25929,72259894.27,87681328240,277297379.7,0.4226349643,0.04905528915,0.001609856518,0.002271596827,728606.2632,80633744910,185284226800,145971798.7,25170751.21,5392708992,0.2570588133,0.01157149895,0.02310614263,0.001149286236,0.0002879157458,0.04542795273,576.0455504,-2.793514104e-005,0.2931167767,0.4946036046,0.6763096837,3.737718332,2.531869889,2.011396062,15.31088759,14.44479596,7.602661851,10.35031701,6.038581658,14.49271661,11.69518917,11.63874192,5.926935753,18.60211545,17.92100711,13.7528366,15.62351481,6.486663244,11.33101176,17.82087091,1.673230515,14.54795792,13.05777889,7.882794776,11.83359406,11.72692394,7.254647519,8.880595332,5.16513363,11.18204102,8.107473352,8.747513987,4.21011307,15.6328628,13.11468789,12.08056989,11.43479982,6.298968591,9.160135146,14.94151888,1.668457046,12.85806115,10.49583203,7.238247969,2.049319983,7.773501352e-013,0.1235580272,0.0152665861,-0.6706712246,1.936019659],[0.642163452522759,0.0209384176755832,0.545530274101811,0.0662153222398581,9.57278386336558,9.38917348561591,9.13162690331351,73.345357253455,70.7690733402266,4.74633771250715,0.783973588490628,3.08799200096576,0.204702319405006,9.62092240831816,74.9904027335282,4.85362659626397,0.790686688746241,3.20408034725466,0.205206195577437,0.330778961070317,18.3956346477853,0.0123869559055862,0.00463985975446534,2.27284632301612,0.0294951265726448,0.0618560488759887,1.47566515534276,0.764857786199042,2.49466993486351,2.17794177080982,27.1497299538638,9.47341003448403,0.18481233236932,3.05701936249167,0.174451378573716,1.32583992483847,2.75822079224031,0.957196768894044,0.000119939443460115,1.73305322716942,1.84160180135732,1.55190187011542,0.141594453163135,0.254773170233312,2.16433186544407,0.0929152910672202,0.141594453163135,2.77753342116175,22.8665148039869,1.45712853566236,1.86341281630039,27.5101378836151,0.639592070248736,0.0451179122730589,5.79146874655553,1.95242306703128,682.289487820368,14.5871130317704,0.02467591465411,0.128032806890089,1.38593450432914,9.94265893832667,0.232426041494003,0.377353516373351,3.88794266309055,0.0115340405095448,0.133579672795411,1.98416726589441,2.00054061714334,259.68241892055,259.68241892055,26.5948436881636,14.3807808596674,0.62011898169523,0.224292643795072,1.38593017278301,9.94259484218355,0.227304753280805,1.06202400760013,1255529.2494687,5386014366421.81,2.22572276341624e+019,7.06408353532449e+015,0.432446645415988,0.0502340602177077,0.0015230070096083,0.0349381847651684,1581415200.00498,1.70854899736501e+019,1.29598058554981e+020,4.03335764971303e+015,2.01287372595513e+015,4.19363457286504e+016,0.402529489242851,0.0565530322571939,0.460476020369094,0.0234736969961131,0.0158307051500476,0.203330234780941,3324.416532166,0.0293626106138257,0.285843906465745,0.462282139309414,0.594563296816042,6.84679022402246,3.99151970222801,2.7793503050959,607309.65001075,1026767024610.01,7.15563253611607e+017,1.07531189962387e+015,0.64647029069963,0.120173118889272,0.00635004042635526,0.176868199236878,750308102.15887,2.17131826420298e+018,1.86215914866622e+019,648730702612850,364343237939403,7.28006651883791e+015,1.04841939532164,0.419147276950515,5.20091199684312,0.132395573361153,0.102747156111434,0.929743196885958,1797.63063080616,0.0263408129296082,0.290956625411365,0.464492743389517,0.598695952326272,6.50883999631007,3.75950996746171,2.61504864707276,34.0138492261504,23.5086803339053,14.3423856094811,23.2314413135559,12.7867989990214,29.5870655283816,26.383022351861,21.0747136525405,12.8835037082406,33.4346226236623,38.7972980566777,24.9357063939174,34.9072359374807,15.1754833326816,24.3755074428942,37.0856382813863,1.46597005734683,31.8029862811399,30.0704187836964,17.7825608043778,25.0029229420053,17.2629382433801,12.5771461029651,18.444820207576,9.59300606846598,21.5359267481736,20.5446543785981,14.8282593974367,11.1490307870194,24.7471299782953,28.4009677361051,19.5050776874692,26.0774227673164,12.5606012512171,18.4612020760583,27.4913563982612,1.4568090599739,24.3510104973387,22.7177886343405,15.2164641087873,215.328012890832,215.328012890832,20.273410433386,12.3754377500667,0.673101056343064,0.213384963049237,1.3834184085131,9.91520369810625,0.213228872123315,1.22338772746598,944841.148084996,3050771230222.58,6.82048819431943e+018,3.97410426098398e+015,0.458330836042453,0.0570796144441137,0.00185451773873945,0.0861150130864664,1193281711.48994,8.67428802540406e+018,7.5537742129396e+019,2.29787561404563e+015,1.18038984930726e+015,2.50283368197313e+016,0.528878459750687,0.14636976916034,1.71390789315275,0.0703451210559694,0.0598318597021553,0.404672137086033,2555.36111059655,0.0229655651315921,0.299043285578078,0.468391232975182,0.608622736069697,6.26569026949744,3.59826623827759,2.51198160309127,512810.718274875,761957688132.228,4.33705039922105e+017,809676126431067,0.650778397088964,0.122456751608405,0.00649751759367915,0.507378573730781,634130938.572138,1.53605427858922e+018,1.41240021865814e+019,499830639146591,293266980947526,5.57119662638814e+015,1.27813080650879,1.32203787326795,27.2686564376171,0.468083302968394,0.44188645578178,2.00361936615484,1559.86149725579,0.0178028036487854,0.303720854425305,0.470745323329527,0.612409123591547,5.98474623824735,3.40968011219305,2.38039444364084,29.2832296933747,20.1022777027063,13.1682969128897,20.308791709338,11.2257998131943,25.2034585251078,22.4444118552593,18.1574929242656,11.290208422819,28.2930620547019,33.006686157445,20.9358884807999,29.5224276993053,13.4421637618209,20.6783216871786,31.1977840456192,1.58562013432023,26.5002987453977,25.7917068524335,14.9068222315888,22.8501151145223,15.6506919383114,12.0240316121655,17.0005455515,8.96777683312423,19.5415788809033,18.0740656854523,13.6536953556667,9.92575850816846,22.2027691017858,25.2897521419656,17.3561439461776,23.0215020123963,11.6921030032238,16.6748259799497,24.2892432289391,1.57783206623392,21.2568131401928,20.666964962629,13.1583224246411,179.435926371094,179.435926371094,15.5657138298263,10.603655859048,0.703273002301258,0.201792069685325,1.36032983247348,9.71622300086208,0.199259796944547,1.22633487820368,747915.167025142,1906820147679.44,3.05327078761019e+018,2.52276034049803e+015,0.478550537283828,0.0649036130636124,0.00234243941587392,0.199988612058774,945870498.658102,5.14615274245454e+018,5.01805820123648e+019,1.4914168462676e+015,803854516829446,1.66453713465829e+016,0.684660397743408,0.360118603050055,6.40216111101961,0.178740314069975,0.164574782083239,0.806214363148748,2071.22857342403,0.00918253767967251,0.319521178219329,0.484325586499839,0.625485718700297,5.83574511788056,3.33058571494586,2.33761963271737,448062.351614509,581492401266.051,2.75830281977644e+017,630512092392261,0.637145136911667,0.121963566025106,0.00683558285188719,1.03137262898016,553496583.041982,1.12876360681781e+018,1.11234993408329e+019,399731030208930,245876988752789,4.38743275413254e+015,1.48395788072005,3.58798029396567,73.8898443192036,0.98529889914518,0.954583079263134,3.57443181900787,1410.95970529363,0.000744083774951133,0.323990417631283,0.48683790553821,0.629053466062033,5.58797139667772,3.16762914928061,2.22547147921826,26.160839094237,17.8124918347677,12.4814603683903,18.462678335926,10.1600824786922,22.2724302809732,19.601261173513,16.159106791196,10.0604216013425,24.7226154078637,28.8830455577594,18.1745388783808,25.6951251702868,12.319263483,18.2712631486643,27.0404672394713,1.70934524247376,22.7708746591633,23.0249373622301,12.906468028386,21.5669242660482,14.6593027010759,11.845617942054,16.2300753480943,8.60007399538196,18.2966003716709,16.4089151912352,12.9122467551472,9.12444153061644,20.5219017914893,23.1757008176331,15.9514328608265,20.9431284948475,11.2250041942232,15.5937691690438,22.0681897705616,1.7025802858431,19.1032724455891,19.4679120890383,11.7697199934149,2.13380712728003,7.36735368571429e-011,0.128973292290212,0.0193756769591281,-0.703016561524695,2.7202868218819],[0.858457468875,0,0.82324769275,0,9,8,8,55,53,4,0,4,0,8,55,4,0,4,0,0,21,0,0,0,0,0,1.931034483,0,0,0,24,11,0,0,0,0,0,0,0,1,0,2,0,0.3333333333,0,0,0,3,21,1,2,25,0,0,11,2,509.712,14.2098481475,0.029843775,0.149438,1.55904,11.637891925,0.267464240075,0.024,6,0,0,3,3,59,59,23.344,13.8790126675,0.736467539,0.253878904775,1.5590375365,11.637891925,0.2536982609,1,226316.52195,12595349220,192917956250000,458878854900,0.50759629575,0.05152125819,0.001265305779,0.01913040054,27992665.56,110714961950000,360009841750000,261510905200,103527573100,2947086767500,0.41655035425,0.0183187194,0.094177741055,0.01189254648,0.005715978324,0.1121919232,2918,0.55021962235,0.43341900965,0.667120814,0.77683454385,7.5000688245,4.333694476,3.2128424845,101227.74525,2590890627.5,18614020410000,101934822900,0.82390827755,0.14419423495,0.006153551328,0.074954684805,11602430.185,18697142330000,63853904870000,67238410330,35160596410,536295124650,1.134114339,0.1426004403,0.67698881205,0.051015466905,0.0290126955,0.4833605781,1734.880829,0.58794991745,0.44497923135,0.6743005978,0.78338589505,7.164825555,4.032231831,2.976262378,38.632106135,26.39358229,15.822535125,26.75507977,15.38409488,34.57779027,30.33694488,24.535368345,15.333781875,37.433132075,43.848042445,28.79918919,39.723474555,18.570990405,29.13976982,42.3766479,1.6067285405,36.992312835,34.366703375,22.146216255,28.763261955,20.35122329,14.040950495,21.525398975,11.30524316,25.46137151,25.236529345,17.371643225,14.47388618,28.14053198,33.55832766,23.52341497,31.106937285,14.94293922,22.20168231,31.818616665,1.602020756,28.422533665,26.280371295,19.409980005,37,37,17.776,12.0949628325,0.804359923375,0.24286434505,1.5590375365,11.637891925,0.2369664166,1,142172.42505,5074702623.5,50264566635000,145307812650,0.53290376285,0.054268468905,0.0013282487685,0.023535434065,14610484.83,30144115170000,97019260645000,85363372250,34653627090,952338488150,0.47550246095,0.02144872665,0.12831335265,0.015445371845,0.007975459644,0.1374342955,2238,0.3937408609,0.46479039715,0.68552938675,0.79077268975,6.8870069865,3.937489189,2.984367515,75165.0244,1465556570.5,8125625550500,44593233350,0.79713014355,0.1313080404,0.005350823976,0.06989164835,7121078.1135,7122963112500,23697973005000,29922598920,15594867545,238416380300,1.0843824705,0.11838199335,0.6488308893,0.049673347985,0.029550845485,0.45643332895,1523.56424,0.4090664762,0.47373010515,0.69112033615,0.795890081,6.611096188,3.6689112995,2.7797718505,32.4264979,23.11456562,13.551476275,22.24242574,13.44672099,29.226556105,25.14457061,21.31393627,13.11389694,31.947777345,36.96041705,24.580722425,33.161793865,16.006728615,24.472745945,35.797187875,1.7631500805,30.76595369,28.497685405,18.404626375,25.587039385,19.071553945,12.38348245,18.88527037,10.40070492,22.88454567,22.154463965,15.993293505,12.485858985,25.927586365,30.08635014,21.50221631,27.64827709,13.41892302,19.759823385,28.658689795,1.7602907175,25.33594553,23.083214745,16.992785125,24,24,13.792,10.51276652,0.86860816075,0.231118358975,1.55884647375,11.637891925,0.2203597859,1,98433.00234,2464060232.5,17449815115000,54028517005,0.53041148615,0.05324823802,0.0012929079025,0.02379654543,8629277.2425,10613851620000,32791521270000,32830291340,13687151805,380897434650,0.48324129745,0.02104606812,0.13439132775,0.01601264493,0.008438400411,0.14019915865,1821,0.26854723225,0.50017622425,0.7093835966,0.8051736002,6.416710996,3.6410793725,2.8245359335,60393.69332,967493748.4,4494720306000,21558768980,0.7380541715,0.1132236909,0.004397675787,0.05398969774,4826698.2225,3286258415500,10432681090000,14480796495,7516310790,126561146500,0.93610135735,0.085808453705,0.49053736005,0.039555846645,0.023219521245,0.36651963985,1401.311317,0.2736592991,0.507340797,0.71394257185,0.80936660095,6.16363626,3.399155576,2.6410065795,27.718431145,20.85022127,11.832964605,18.75275793,11.90327076,25.34293962,21.298902395,18.90041218,11.328812805,28.026224435,31.795335665,21.61611706,28.175099985,13.976627465,21.05663684,30.925955315,1.908485447,26.22034932,24.08502952,15.47873741,23.21199145,18.290391855,11.23325751,16.93296899,9.6703944895,20.89905672,19.678718685,14.97431779,10.753669115,24.378748015,27.39342604,20.09044964,24.931327445,12.22301562,17.90045574,26.27005258,1.9061927615,23.011863665,20.679591355,15.11196352,2.426427126,5.227542704e-011,0.1592017082,0.02534518391,-0.5038249493,3.254840374],[1,0.9962546816,1,1,129,65,65,410,410,55,9,17,4,65,410,55,9,17,4,704,326,54,33,252,560,404,6.458598726,478,170,163,2088,163,424,588,671,88,212,386,0.4666666667,572,129,251,1,1,698,146,1,76,711,155,5,808,1389,104,310,96,41864.88,338.4979688,0.29813,1.87766,35.3414,133.7479711,4.035154736,42.08,113,7,9,36,40,60789,60789,2092.32,338.4980383,8.596871096,8.010635794,35.34144974,133.7479711,8.819475282,28,588212114.7,6.888129656e+016,2.15165555e+024,2.817306324e+020,6.708324513,6.010881387,0.4110453704,155.1443832,3326916479000,4.773029167e+023,8.06855517e+024,1.852263209e+020,1.208901132e+020,1.109794716e+021,73.61963053,256.3513333,4915.659389,137.335384,125.4627179,383.3734455,261540,70.04395863,0.9947771112,1,1,65.46149163,32.36284496,17.82029572,150313654.6,1.916758502e+015,6.663463493e+021,4.542256673e+018,16.16370862,29.4000924,27.99506456,1334.43862,990051101700,1.866555594e+022,7.406412842e+023,3.17951182e+018,2.271015252e+018,1.032783798e+020,695.5847698,5359.885141,479209.5183,1334.116112,1333.901107,8308.383531,42312.25479,84.25782592,0.9958993203,0.9999998643,0.9999999613,66.56474052,32.97918301,16.42468609,463.8681726,249.8761208,202.885987,291.2821015,205.5090733,414.398987,403.5347366,297.2757961,232.448102,392.4773208,522.735956,303.2521077,481.2019467,259.8876551,348.1609557,483.9230177,2.403245936,428.7811241,410.7778262,281.3879693,200.293645,100.5052573,126.9187798,156.594798,88.53859908,168.8863045,158.1679893,120.8635572,122.4933814,151.5538766,236.8898517,116.8793604,203.5042075,117.9185669,149.525758,201.2574831,2.403570595,154.3813942,186.2374893,116.3074367,48509,48509,1152.608,252.7445164,8.85745132,8.07543616,35.34144974,133.7479711,8.644498705,24,418594472.5,1.565398218e+016,1.55777838e+023,4.413180093e+019,13.34290767,11.75142891,1.2316115,530.3768994,2790225530000,1.615829261e+023,5.787248544e+024,2.962399006e+019,1.995211614e+019,8.024598068e+020,226.3501776,6729.605059,50206.05828,555.1353547,571.6409916,2366.273072,144076,91.32459492,0.9936373691,1,1,65.52826081,32.86795962,16.44786695,138763413.1,1.563895531e+015,4.31641912e+021,3.410334005e+018,24.45427429,26.66991748,24.61131367,11787.1847,903535581400,1.39311011e+022,6.272151507e+023,1.714863712e+018,1.181968335e+018,8.776480769e+019,1178.102216,70258.06697,1355776.569,12736.43029,13369.26068,21558.73093,31593.06455,126.3449143,0.9917510745,0.9999998956,0.9999999892,66.69096176,33.14079082,16.25849156,343.4878655,185.4605386,181.7380542,254.8664431,148.6421615,298.2798858,327.5722575,207.9117429,263.6183335,278.5962276,386.2965779,252.2082565,356.030012,174.0537989,254.1818387,341.3633958,4.247544914,312.9648804,318.9925508,275.1723807,192.6664747,86.84635044,125.1703254,152.7536465,86.31976138,163.2005277,155.7131659,117.4498421,117.454081,146.4434071,229.3363912,106.4925779,192.3706307,114.6306509,144.3471222,196.1769967,4.242201183,147.9931403,177.8600516,111.2181591,38465,38465,693.432,209.2434768,9.763456115,8.071617567,35.34144974,133.7479711,8.409403585,26,357504080,1.083363207e+016,8.083815533e+022,2.481272363e+019,19.10030514,21.69250839,6.417807076,2018.537968,2339170431000,9.965929314e+022,4.15073094e+024,1.221355845e+019,8.143508412e+018,5.81185942e+020,451.2703807,13856.09008,194700.7077,2016.395082,2014.966492,5890.9234,86679,111.9522236,0.9950984259,1,1,65.62550581,33.30702555,16.07984754,127421037.2,1.258478005e+015,3.042779018e+021,2.695819959e+018,38.79326536,115.5475918,113.0485047,20661.91005,818974377100,1.013233586e+022,5.24536439e+023,1.366247614e+018,1.060077432e+018,7.371214462e+019,1857.549556,302224.5416,3300967.221,20641.98158,20628.69594,49261.81838,26155.4346,122.9988306,0.9964265156,0.9999999301,0.9999999766,66.84701419,32.35449294,16.17070596,315.0864264,143.8509192,168.2554159,230.9961724,138.5620208,270.3931358,267.1686442,190.7194818,170.2523619,238.9882228,359.9404235,168.1792169,340.3330636,160.2240489,229.2673611,321.5411926,5.053228749,277.4498917,290.4976389,162.6863137,186.413893,79.01993455,122.9814966,149.7533085,83.37841647,155.966169,153.3003887,113.0291018,115.1505833,141.2304331,220.9471727,95.09070564,185.1065639,111.3185305,138.1697027,191.1664789,5.050802593,144.655878,170.1622892,107.2688947,8.999694824,3.621388771e-007,0.7974733462,0.635963738,-0.01075177453,45.26153183],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,0,0,0,7,0,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,3159,0,0,0,0,0,0,0,0,13,0,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,23091,0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Min.<\/th>\n      <th>1st Qu.<\/th>\n      <th>Median<\/th>\n      <th>Mean<\/th>\n      <th>3rd Qu.<\/th>\n      <th>Max.<\/th>\n      <th>NA's<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->

#Korelacje między zmiennymi

##Korelacje liczb atomów i elektronów ligandu zamodelowanych w pliku PDB oraz wyliczonych na podstawie danych słownikowych
<img src="ProjektZAnalizyDanych_files/figure-html/korelacja1-1.png" style="display: block; margin: auto;" />
Wyraźnie widoczna jest silna korelacja pomiędzy liczbą atomów i elektronów ligandu zamodelowaną w pliku PDB oraz wyliczonych na podstawie danych słownikowych. Zbliżona wartość danych zamodelowanych do słownikowych potwierdza ich wiarygodność. Użycie tych atybutów do budowy regresora przewidującego liczbę atomów i elektronów powinno dać w rezultacie bardzo dobrą trafność regresji.

##Korelacje wartości obliczonych tylko na podstawie ligandu z odcięciem intensywności równym 1
<img src="ProjektZAnalizyDanych_files/figure-html/korelacja2-1.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/korelacja2-2.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/korelacja2-3.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/korelacja2-4.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/korelacja2-5.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/korelacja2-6.png" style="display: block; margin: auto;" />

Z powyższych wykresów wynika, że kolumny dotyczące niezmienników kształtu I2, I3, I4, I5 prawdopodobnie nie będą miały dużego wpływu na predykcję liczby atomów i elektronów. Natomiast kolumny part_01_* _Z_* oraz part_01_* _E_* mogą mież duży wpływ na trafność regresji analizowanej w dalszej sekcji.

##Korelacje pomiędzy pozostałymi zmiennymi obliczanymi tylko na podstawie ligandu bez określenia progu intensywności
<img src="ProjektZAnalizyDanych_files/figure-html/korelacja3-1.png" style="display: block; margin: auto;" />
Z wykresu wynika, że szczególnie przydatne do predykcji liczby atomów i elektronów mogą być atrybuty local_volume oraz local_electrons.

##Korelacje między wartościami obliczonymi na podstawie całego pliku PDB
<img src="ProjektZAnalizyDanych_files/figure-html/korelacja4-1.png" style="display: block; margin: auto;" />
Dane dotyczące wartościami obliczonymi na podstawie całego pliku PDB zupełnie nie są skorelowane z wartościami liczby elektronów, a zatem będzie je można pominąć przy budowie regresora.

#Określenie ile przykładów ma każda z klas (res_name).
Wykres przedstawia zestawienie liczności 50 najpopularniejszych klas.
<!--html_preserve--><div id="htmlwidget-ddb36350d8238497f1a0" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ddb36350d8238497f1a0">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[56572,40606,30825,26360,23223,21038,19826,14779,11192,11090,9613,8096,6633,6317,4987,4784,4706,4555,4501,4215,3819,3509,3505,3242,3221,2918,2841,2768,2697,2353,2296,2183,2136,2127,2106,2084,1933,1917,1905,1656,1647,1637,1609,1602,1596,1594,1589,1587,1560,1491],"text":["Klasa: SO4<br />Liczebność: 56572","Klasa: GOL<br />Liczebność: 40606","Klasa: EDO<br />Liczebność: 30825","Klasa: NAG<br />Liczebność: 26360","Klasa: CL<br />Liczebność: 23223","Klasa: CA<br />Liczebność: 21038","Klasa: ZN<br />Liczebność: 19826","Klasa: MG<br />Liczebność: 14779","Klasa: HEM<br />Liczebność: 11192","Klasa: PO4<br />Liczebność: 11090","Klasa: NA<br />Liczebność: 9613","Klasa: ACT<br />Liczebność: 8096","Klasa: DMS<br />Liczebność: 6633","Klasa: IOD<br />Liczebność: 6317","Klasa: PEG<br />Liczebność: 4987","Klasa: CLA<br />Liczebność: 4784","Klasa: K<br />Liczebność: 4706","Klasa: FAD<br />Liczebność: 4555","Klasa: NAD<br />Liczebność: 4501","Klasa: MN<br />Liczebność: 4215","Klasa: ADP<br />Liczebność: 3819","Klasa: MLY<br />Liczebność: 3509","Klasa: NAP<br />Liczebność: 3505","Klasa: CD<br />Liczebność: 3242","Klasa: MPD<br />Liczebność: 3221","Klasa: FMT<br />Liczebność: 2918","Klasa: MAN<br />Liczebność: 2841","Klasa: PG4<br />Liczebność: 2768","Klasa: MES<br />Liczebność: 2697","Klasa: CU<br />Liczebność: 2353","Klasa: ATP<br />Liczebność: 2296","Klasa: COA<br />Liczebność: 2183","Klasa: 1PE<br />Liczebność: 2136","Klasa: BR<br />Liczebność: 2127","Klasa: NDP<br />Liczebność: 2106","Klasa: FMN<br />Liczebność: 2084","Klasa: EPE<br />Liczebność: 1933","Klasa: HEC<br />Liczebność: 1917","Klasa: PGE<br />Liczebność: 1905","Klasa: TRS<br />Liczebność: 1656","Klasa: SF4<br />Liczebność: 1647","Klasa: NI<br />Liczebność: 1637","Klasa: ACY<br />Liczebność: 1609","Klasa: FE<br />Liczebność: 1602","Klasa: NO3<br />Liczebność: 1596","Klasa: PLP<br />Liczebność: 1594","Klasa: GDP<br />Liczebność: 1589","Klasa: SAH<br />Liczebność: 1587","Klasa: FE2<br />Liczebność: 1560","Klasa: SEP<br />Liczebność: 1491"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.88976377952756,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.2237442922374,"r":7.30593607305936,"b":47.4885844748859,"l":54.7945205479452},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":"50 najliczniejszych klas","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,50.6],"tickmode":"array","ticktext":["SO4","GOL","EDO","NAG","CL","CA","ZN","MG","HEM","PO4","NA","ACT","DMS","IOD","PEG","CLA","K","FAD","NAD","MN","ADP","MLY","NAP","CD","MPD","FMT","MAN","PG4","MES","CU","ATP","COA","1PE","BR","NDP","FMN","EPE","HEC","PGE","TRS","SF4","NI","ACY","FE","NO3","PLP","GDP","SAH","FE2","SEP"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"categoryorder":"array","categoryarray":["SO4","GOL","EDO","NAG","CL","CA","ZN","MG","HEM","PO4","NA","ACT","DMS","IOD","PEG","CLA","K","FAD","NAD","MN","ADP","MLY","NAP","CD","MPD","FMT","MAN","PG4","MES","CU","ATP","COA","1PE","BR","NDP","FMN","EPE","HEC","PGE","TRS","SF4","NI","ACY","FE","NO3","PLP","GDP","SAH","FE2","SEP"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Klasa","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2828.6,59400.6],"tickmode":"array","ticktext":["0","20000","40000"],"tickvals":[0,20000,40000],"categoryorder":"array","categoryarray":["0","20000","40000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Liczność","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"2e6c1dcf5dab":{"text":{},"x":{},"y":{},"type":"bar"}},"cur_data":"2e6c1dcf5dab","visdat":{"2e6c1dcf5dab":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->
Widoczny na wykresie znaczny rozrzut liczebności klas co może utrudnić budowę klasyfikatora. Konieczne będzie zasotowanie mechanizmu stratyfikacji. 

#Wykresy rozkładów liczby atomów i elektronów
##Rozkład liczby atomów
Na wykresie rozkładu liczby atomów można zauważyć duże niezrównoważenie liczby atomów. Zdecydowana większość ligandów zawiera niewielką liczbę atomów. Powyżej 20 atomów w cząsteczce posiadają jedynie nieliczne bardziej złożone ligandy.
<img src="ProjektZAnalizyDanych_files/figure-html/rozklad_atom-1.png" style="display: block; margin: auto;" />

##Rozkład liczby elektronów
Wysoki stopień korelacji przedstawiony we wcześniejszej sekcji znajduje swoje odzwierciedlenie również tutaj. Biorąc pod uwagę fakt, że w skład atomu wchodzą elektrony to wraz ze zmianą liczności atomów w ligandzie zmienia się również proporcjonalnie liczba elektronów. Co tłumaczy podobny kształt wykresu rozkładu elektronów do rozkładu atomów.
<img src="ProjektZAnalizyDanych_files/figure-html/rozklad_electron-1.png" style="display: block; margin: auto;" />

##Porównanie średniej liczby atomów i elektronów w poszczególnych klasach
Poniższy wykres potwierdza, iż zdecydowanie radziej zdarzają się ligandy złożone z wielu atomów i elektronów. Najliczniejsze klasy posiadają niską średnią wartość liczby elektronów i atomów, natomiast mniejliczne klasy cechują się wyższą średnią liczbą atomów i elektronów. 
<!--html_preserve--><div id="htmlwidget-964625cd62d2afe21cc7" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-964625cd62d2afe21cc7">{"x":{"data":[{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,95.1613050075873,89.8380149812734,90.6829810901001,80.9400289017341,0,76.844772967265,68.0239384440011,0,0,0,0,53,47.9861415541257,46.9446348061317,48,0,35.9966832504146,35,0,0,0,0,30,29,28,26,26,25,21.9979437971213,20,19,17,12,11],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[59.7548076923077,52.7227222832053,46.1653687585891,47.0118708452042,46.7166904422254,43.3114863363697,42.9935668334525,42.9374021909233,30.7203832752613,30.9534548944338,27.9628697293896,26.9518198481278,25.9628229363579,7.9933211900425,15.1373902132999,14.5173305742369,14.0198786039454,13.3366104868914,11.9595847237672,11.9559248554913,9.99128101945003,11.1055966209081,10.6734112282702,9.60682414698163,7.97342995169082,7.98882334678671,6.93864046520955,1,4.99830304744396,4.99323715058611,1,5.99682312958676,3.99954771596563,1,4,3.99935117599351,3.99740612648221,3.99254195152268,1,1,1,1,1,1,2.99965729952022,1,1,1,1,1],"text":["Klasa: CLA<br />Liczebność: 59.7548076923077<br />srednia_liczba_atomow","Klasa: FAD<br />Liczebność: 52.7227222832053<br />srednia_liczba_atomow","Klasa: COA<br />Liczebność: 46.1653687585891<br />srednia_liczba_atomow","Klasa: NDP<br />Liczebność: 47.0118708452042<br />srednia_liczba_atomow","Klasa: NAP<br />Liczebność: 46.7166904422254<br />srednia_liczba_atomow","Klasa: NAD<br />Liczebność: 43.3114863363697<br />srednia_liczba_atomow","Klasa: HEM<br />Liczebność: 42.9935668334525<br />srednia_liczba_atomow","Klasa: HEC<br />Liczebność: 42.9374021909233<br />srednia_liczba_atomow","Klasa: ATP<br />Liczebność: 30.7203832752613<br />srednia_liczba_atomow","Klasa: FMN<br />Liczebność: 30.9534548944338<br />srednia_liczba_atomow","Klasa: GDP<br />Liczebność: 27.9628697293896<br />srednia_liczba_atomow","Klasa: ADP<br />Liczebność: 26.9518198481278<br />srednia_liczba_atomow","Klasa: SAH<br />Liczebność: 25.9628229363579<br />srednia_liczba_atomow","Klasa: SF4<br />Liczebność: 7.9933211900425<br />srednia_liczba_atomow","Klasa: PLP<br />Liczebność: 15.1373902132999<br />srednia_liczba_atomow","Klasa: EPE<br />Liczebność: 14.5173305742369<br />srednia_liczba_atomow","Klasa: NAG<br />Liczebność: 14.0198786039454<br />srednia_liczba_atomow","Klasa: 1PE<br />Liczebność: 13.3366104868914<br />srednia_liczba_atomow","Klasa: MES<br />Liczebność: 11.9595847237671<br />srednia_liczba_atomow","Klasa: PG4<br />Liczebność: 11.9559248554913<br />srednia_liczba_atomow","Klasa: SEP<br />Liczebność: 9.99128101945003<br />srednia_liczba_atomow","Klasa: MAN<br />Liczebność: 11.1055966209081<br />srednia_liczba_atomow","Klasa: MLY<br />Liczebność: 10.6734112282702<br />srednia_liczba_atomow","Klasa: PGE<br />Liczebność: 9.60682414698163<br />srednia_liczba_atomow","Klasa: TRS<br />Liczebność: 7.97342995169082<br />srednia_liczba_atomow","Klasa: MPD<br />Liczebność: 7.98882334678671<br />srednia_liczba_atomow","Klasa: PEG<br />Liczebność: 6.93864046520955<br />srednia_liczba_atomow","Klasa: IOD<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: SO4<br />Liczebność: 4.99830304744397<br />srednia_liczba_atomow","Klasa: PO4<br />Liczebność: 4.99323715058611<br />srednia_liczba_atomow","Klasa: CD<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: GOL<br />Liczebność: 5.99682312958676<br />srednia_liczba_atomow","Klasa: DMS<br />Liczebność: 3.99954771596563<br />srednia_liczba_atomow","Klasa: BR<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: NO3<br />Liczebność: 4<br />srednia_liczba_atomow","Klasa: EDO<br />Liczebność: 3.99935117599351<br />srednia_liczba_atomow","Klasa: ACT<br />Liczebność: 3.99740612648221<br />srednia_liczba_atomow","Klasa: ACY<br />Liczebność: 3.99254195152268<br />srednia_liczba_atomow","Klasa: ZN<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: CU<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: NI<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: FE<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: FE2<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: MN<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: FMT<br />Liczebność: 2.99965729952022<br />srednia_liczba_atomow","Klasa: CA<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: K<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: CL<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: MG<br />Liczebność: 1<br />srednia_liczba_atomow","Klasa: NA<br />Liczebność: 1<br />srednia_liczba_atomow"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(127,127,127,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"srednia_liczba_atomow","legendgroup":"srednia_liczba_atomow","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.900000000000002,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006,0.900000000000006],"base":[59.7548076923077,52.7227222832053,46.1653687585891,47.0118708452042,46.7166904422254,43.3114863363697,42.9935668334525,42.9374021909233,30.7203832752613,30.9534548944338,27.9628697293896,26.9518198481278,25.9628229363579,7.9933211900425,15.1373902132999,14.5173305742369,0,0,0,0,9.99128101945003,0,0,9.60682414698163,7.97342995169082,7.98882334678671,6.93864046520955,0,0,0,0,5.99682312958676,0,0,4,3.99935117599351,3.99740612648221,3.99254195152268,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[378.153010033445,373.074862788145,350.21667430142,349.258309591643,347.369757489301,312.381692957121,289.957648320229,289.568075117371,241.912456445993,216.624760076775,212.736941472624,204.629484158157,181.725267800882,167.850637522769,111.125470514429,106.713916192447,95.1613050075873,89.8380149812734,90.6829810901001,80.9400289017341,79.8739101274313,76.844772967265,68.0239384440011,65.3700787401575,54.8121980676328,51.9254889785781,47.5773009825546,53,47.9861415541257,46.9446348061317,48,41.9772939959612,35.9966832504146,35,31,27.9948742903487,27.9814723320158,27.941578620261,30,29,28,26,26,25,21.9979437971213,20,19,17,12,11],"text":["Klasa: CLA<br />Liczebność: 378.153010033445<br />srednia_liczba_elektronow","Klasa: FAD<br />Liczebność: 373.074862788145<br />srednia_liczba_elektronow","Klasa: COA<br />Liczebność: 350.21667430142<br />srednia_liczba_elektronow","Klasa: NDP<br />Liczebność: 349.258309591643<br />srednia_liczba_elektronow","Klasa: NAP<br />Liczebność: 347.369757489301<br />srednia_liczba_elektronow","Klasa: NAD<br />Liczebność: 312.381692957121<br />srednia_liczba_elektronow","Klasa: HEM<br />Liczebność: 289.957648320229<br />srednia_liczba_elektronow","Klasa: HEC<br />Liczebność: 289.568075117371<br />srednia_liczba_elektronow","Klasa: ATP<br />Liczebność: 241.912456445993<br />srednia_liczba_elektronow","Klasa: FMN<br />Liczebność: 216.624760076775<br />srednia_liczba_elektronow","Klasa: GDP<br />Liczebność: 212.736941472624<br />srednia_liczba_elektronow","Klasa: ADP<br />Liczebność: 204.629484158157<br />srednia_liczba_elektronow","Klasa: SAH<br />Liczebność: 181.725267800882<br />srednia_liczba_elektronow","Klasa: SF4<br />Liczebność: 167.850637522769<br />srednia_liczba_elektronow","Klasa: PLP<br />Liczebność: 111.125470514429<br />srednia_liczba_elektronow","Klasa: EPE<br />Liczebność: 106.713916192447<br />srednia_liczba_elektronow","Klasa: NAG<br />Liczebność: 95.1613050075873<br />srednia_liczba_elektronow","Klasa: 1PE<br />Liczebność: 89.8380149812734<br />srednia_liczba_elektronow","Klasa: MES<br />Liczebność: 90.6829810901001<br />srednia_liczba_elektronow","Klasa: PG4<br />Liczebność: 80.9400289017341<br />srednia_liczba_elektronow","Klasa: SEP<br />Liczebność: 79.8739101274313<br />srednia_liczba_elektronow","Klasa: MAN<br />Liczebność: 76.844772967265<br />srednia_liczba_elektronow","Klasa: MLY<br />Liczebność: 68.0239384440011<br />srednia_liczba_elektronow","Klasa: PGE<br />Liczebność: 65.3700787401575<br />srednia_liczba_elektronow","Klasa: TRS<br />Liczebność: 54.8121980676328<br />srednia_liczba_elektronow","Klasa: MPD<br />Liczebność: 51.9254889785781<br />srednia_liczba_elektronow","Klasa: PEG<br />Liczebność: 47.5773009825546<br />srednia_liczba_elektronow","Klasa: IOD<br />Liczebność: 53<br />srednia_liczba_elektronow","Klasa: SO4<br />Liczebność: 47.9861415541257<br />srednia_liczba_elektronow","Klasa: PO4<br />Liczebność: 46.9446348061317<br />srednia_liczba_elektronow","Klasa: CD<br />Liczebność: 48<br />srednia_liczba_elektronow","Klasa: GOL<br />Liczebność: 41.9772939959612<br />srednia_liczba_elektronow","Klasa: DMS<br />Liczebność: 35.9966832504146<br />srednia_liczba_elektronow","Klasa: BR<br />Liczebność: 35<br />srednia_liczba_elektronow","Klasa: NO3<br />Liczebność: 31<br />srednia_liczba_elektronow","Klasa: EDO<br />Liczebność: 27.9948742903487<br />srednia_liczba_elektronow","Klasa: ACT<br />Liczebność: 27.9814723320158<br />srednia_liczba_elektronow","Klasa: ACY<br />Liczebność: 27.941578620261<br />srednia_liczba_elektronow","Klasa: ZN<br />Liczebność: 30<br />srednia_liczba_elektronow","Klasa: CU<br />Liczebność: 29<br />srednia_liczba_elektronow","Klasa: NI<br />Liczebność: 28<br />srednia_liczba_elektronow","Klasa: FE<br />Liczebność: 26<br />srednia_liczba_elektronow","Klasa: FE2<br />Liczebność: 26<br />srednia_liczba_elektronow","Klasa: MN<br />Liczebność: 25<br />srednia_liczba_elektronow","Klasa: FMT<br />Liczebność: 21.9979437971213<br />srednia_liczba_elektronow","Klasa: CA<br />Liczebność: 20<br />srednia_liczba_elektronow","Klasa: K<br />Liczebność: 19<br />srednia_liczba_elektronow","Klasa: CL<br />Liczebność: 17<br />srednia_liczba_elektronow","Klasa: MG<br />Liczebność: 12<br />srednia_liczba_elektronow","Klasa: NA<br />Liczebność: 11<br />srednia_liczba_elektronow"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(204,204,204,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"srednia_liczba_elektronow","legendgroup":"srednia_liczba_elektronow","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.2237442922374,"r":7.30593607305936,"b":47.4885844748859,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":"Porównanie średniej liczby atomów i elektronów w poszczególnych klasach","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,50.6],"tickmode":"array","ticktext":["CLA","FAD","COA","NDP","NAP","NAD","HEM","HEC","ATP","FMN","GDP","ADP","SAH","SF4","PLP","EPE","NAG","1PE","MES","PG4","SEP","MAN","MLY","PGE","TRS","MPD","PEG","IOD","SO4","PO4","CD","GOL","DMS","BR","NO3","EDO","ACT","ACY","ZN","CU","NI","FE","FE2","MN","FMT","CA","K","CL","MG","NA"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"categoryorder":"array","categoryarray":["CLA","FAD","COA","NDP","NAP","NAD","HEM","HEC","ATP","FMN","GDP","ADP","SAH","SF4","PLP","EPE","NAG","1PE","MES","PG4","SEP","MAN","MLY","PGE","TRS","MPD","PEG","IOD","SO4","PO4","CD","GOL","DMS","BR","NO3","EDO","ACT","ACY","ZN","CU","NI","FE","FE2","MN","FMT","CA","K","CL","MG","NA"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Klasa","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-21.8953908862876,459.80320861204],"tickmode":"array","ticktext":["0","100","200","300","400"],"tickvals":[0,100,200,300,400],"categoryorder":"array","categoryarray":["0","100","200","300","400"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Liczność","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.93503937007874},"annotations":[{"text":"variable","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"2e6c7dac3c83":{"text":{},"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"2e6c7dac3c83","visdat":{"2e6c7dac3c83":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

#Niezgodność liczby atomów i elektronów
Niezgodność dla każdej klasy została wyliczona jako wartość średnia z różnicy liczby atomów bądź elektronów ligandu zamodelowanej w pliku PDB a liczby atomów bądź elektronów wyliczonej na podstawie danych słownikowych.

##Tabela pokazująca 10 klas z największą niezgodnością liczby atomów (local_res_atom_non_h_count vs dict_atom_non_h_count)
<!--html_preserve--><div id="htmlwidget-9e464d5954cf46f0e62d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9e464d5954cf46f0e62d">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["CLA","1PE","COA","MLY","NAP","PG4","SEP","NDP","NAG","MAN"],[5.24519230769231,2.66338951310861,1.8346312414109,1.32658877172984,1.28330955777461,1.04407514450867,1.00871898054997,0.988129154795821,0.980121396054628,0.894403379091869]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>res_name<\/th>\n      <th>difference<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->

##Tabela pokazująca 10 klas z największą niezgodnością liczby elektronów (local_res_atom_non_h_electron_sum vs dict_atom_non_h_electron_sum)
<!--html_preserve--><div id="htmlwidget-cc1549a9c8c61f5f4cc0" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cc1549a9c8c61f5f4cc0">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["CLA","1PE","COA","MLY","NAP","SEP","NAG","MAN","PG4","PLP"],[31.8469899665552,18.1619850187266,13.7833256985799,9.97606155599886,8.630242510699,8.12608987256875,7.83869499241275,7.15522703273495,7.0599710982659,6.87452948557089]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>res_name<\/th>\n      <th>difference<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->

#Rozkład wartości wszystkich kolumn zaczynających się od part_01
Na wykresach kolorem czerwonym została zaznaczona wrtość średnia. 
<img src="ProjektZAnalizyDanych_files/figure-html/part_01-1.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-2.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-3.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-4.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-5.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-6.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-7.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-8.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-9.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-10.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-11.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-12.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-13.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-14.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-15.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-16.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-17.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-18.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-19.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-20.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-21.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-22.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-23.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-24.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-25.png" style="display: block; margin: auto;" /><img src="ProjektZAnalizyDanych_files/figure-html/part_01-26.png" style="display: block; margin: auto;" />

#Przewidywanie liczby elektronów i atomów na podstawie wartości innych kolumn wraz z oszacowaniem trafności regresji na podstawie miar R^2 i RMSE
Przed przystąpieniem do predykcji wartości liczby atomów i elektronów dokonana zostanie dodatkowa filtracja danych. Na podstawie infromacji uzyskanych w wyniku wcześniejszych punktów możliwe jest pominięcie w dalszych obliczeniach części kolumn słabo skorelowanych z poszukiwanymi atrybutami. 


Do budowy regresora został użyty algorytm regresji liniowej. Zbiór danych został podzielony na dwa zbiory: uczący (75% próbek) oraz testowy (25% próbek). W schemacie uczenia zastosowany został algorytm powtórzonej walidacji krzyżowej. 

##Przewidywanie liczy atomów

###Predykcja liczby atomów oparta o przefiltrowane wartości obliczane na podstawie całego pliku PDB oraz obliczane tylko na podstawie ligandu


```
## Linear Regression 
## 
## 283416 samples
##     62 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (20 fold, repeated 1 times) 
## Summary of sample sizes: 269245, 269245, 269245, 269245, 269245, 269246, ... 
## Resampling results:
## 
##   RMSE      Rsquared   MAE    
##   9.810723  0.4571192  5.45837
## 
## Tuning parameter 'intercept' was held constant at a value of TRUE
```

![](ProjektZAnalizyDanych_files/figure-html/regresja_a_zz-1.png)<!-- -->

###Predykcja liczby atomów oparta o dodatkowo o kolumny zawierające wartości słownikowe oraz wartości zamodelowane w pliku PDB


```
## Linear Regression 
## 
## 283416 samples
##     76 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (20 fold, repeated 1 times) 
## Summary of sample sizes: 269245, 269246, 269245, 269246, 269245, 269246, ... 
## Resampling results:
## 
##   RMSE         Rsquared   MAE         
##   0.002268117  0.9999999  0.0002978884
## 
## Tuning parameter 'intercept' was held constant at a value of TRUE
```

![](ProjektZAnalizyDanych_files/figure-html/regresja_a_zzc-1.png)<!-- -->

##Przewidywanie liczy elektronów
###Predykcja liczby elektronów oparta o przefiltrowane wartości obliczane na podstawie całego pliku PDB oraz obliczane tylko na podstawie ligandu


```
## Linear Regression 
## 
## 283417 samples
##     62 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (20 fold, repeated 1 times) 
## Summary of sample sizes: 269245, 269247, 269247, 269247, 269247, 269246, ... 
## Resampling results:
## 
##   RMSE      Rsquared   MAE     
##   66.04292  0.4559301  36.66236
## 
## Tuning parameter 'intercept' was held constant at a value of TRUE
```

![](ProjektZAnalizyDanych_files/figure-html/regresja_e_zz-1.png)<!-- -->

###Predykcja liczby elektronów oparta o dodatkowo o kolumny zawierające wartości słownikowe oraz wartości zamodelowane w pliku PDB


```
## Linear Regression 
## 
## 283417 samples
##     76 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (20 fold, repeated 1 times) 
## Summary of sample sizes: 269247, 269245, 269246, 269245, 269246, 269245, ... 
## Resampling results:
## 
##   RMSE        Rsquared   MAE        
##   0.03149025  0.9999996  0.003435103
## 
## Tuning parameter 'intercept' was held constant at a value of TRUE
```

![](ProjektZAnalizyDanych_files/figure-html/regresja_e_zzc-1.png)<!-- -->

Jak widać w oby przypadkach zdecydowanie lepszy wynik uzyskaliśmy w wyniku regresji korzystających z danych zamodelowanych w pliku PDB i słownikowych. Jest to związane z silną korelacją tych zmiennych z liczbą atomów i elektronów.

#Budowa klasyfikatora przewidującego wartość atrybutu res_name
Do stworzenia klasyfikatora wykorzystywane były kolumny z pominięciem tych dotyczących watrości zamodelowanych, opartych na danych słownikowych oraz "skeleton". Ze względu na długi czas obliczeń, konieczna była redukcja liczby zmiennych biorących udział w budowie klasyfikatora. Wybór atrybutów został oparty o miarę mutual information. Poniżej przedstawione zostały wyliczone miary.


-------------------------------  ----------
blob_coverage                     2.3691447
res_coverage                      2.3691456
title                             0.1053626
pdb_code                          0.1053355
res_name                          3.0382514
res_id                            0.1322302
chain_id                          0.0194567
blob_volume_coverage              0.2495969
blob_volume_coverage_second       0.0898787
res_volume_coverage               0.4440761
res_volume_coverage_second        0.0948410
local_volume                      0.2713668
local_electrons                   0.3213270
local_mean                        0.2046620
local_std                         0.1869364
local_max                         0.1683923
local_max_over_std                0.2361217
local_skewness                    0.1791040
local_cut_by_mainchain_volume     0.2371719
local_near_cut_count_C            0.1978132
local_near_cut_count_other        0.0140359
local_near_cut_count_S            0.1097525
local_near_cut_count_O            0.2234483
local_near_cut_count_N            0.1849215
resolution                        0.0997946
FoFc_mean                         0.0528482
FoFc_std                          0.0878070
FoFc_square_std                   0.0878070
FoFc_min                          0.0822687
FoFc_max                          0.1193085
part_01_shape_segments_count      0.2645303
part_01_density_segments_count    0.2645303
part_01_volume                    0.2802927
part_01_electrons                 0.3124934
part_01_mean                      0.1333972
part_01_std                       0.1987013
part_01_max                       0.1683924
part_01_max_over_std              0.2361181
part_01_skewness                  0.1905173
part_01_parts                     0.0318876
part_01_shape_O3                  0.2955618
part_01_shape_O4                  0.2979039
part_01_shape_O5                  0.2965167
part_01_shape_FL                  0.2900151
part_01_shape_O3_norm             0.2300543
part_01_shape_O4_norm             0.2319273
part_01_shape_O5_norm             0.2169201
part_01_shape_FL_norm             0.1864856
part_01_shape_I1                  0.3014721
part_01_shape_I2                  0.3031235
part_01_shape_I3                  0.3017501
part_01_shape_I4                  0.2894523
part_01_shape_I5                  0.2859914
part_01_shape_I6                  0.2977169
part_01_shape_I1_norm             0.2250690
part_01_shape_I2_norm             0.2265937
part_01_shape_I3_norm             0.2196014
part_01_shape_I4_norm             0.1870135
part_01_shape_I5_norm             0.1756734
part_01_shape_I6_norm             0.2238600
part_01_shape_M000                0.2802927
part_01_shape_CI                  0.1396236
part_01_shape_E3_E1               0.2247516
part_01_shape_E2_E1               0.1442625
part_01_shape_E3_E2               0.1721688
part_01_shape_sqrt_E1             0.3232966
part_01_shape_sqrt_E2             0.3233869
part_01_shape_sqrt_E3             0.2741935
part_01_density_O3                0.3142637
part_01_density_O4                0.3219817
part_01_density_O5                0.3233830
part_01_density_FL                0.2985308
part_01_density_O3_norm           0.2884064
part_01_density_O4_norm           0.2812386
part_01_density_O5_norm           0.2533358
part_01_density_FL_norm           0.2399764
part_01_density_I1                0.3121641
part_01_density_I2                0.3159896
part_01_density_I3                0.3124345
part_01_density_I4                0.2989005
part_01_density_I5                0.2934945
part_01_density_I6                0.3102946
part_01_density_I1_norm           0.2786944
part_01_density_I2_norm           0.2761159
part_01_density_I3_norm           0.2763006
part_01_density_I4_norm           0.2374666
part_01_density_I5_norm           0.2079595
part_01_density_I6_norm           0.2820457
part_01_density_M000              0.3124934
part_01_density_CI                0.1408813
part_01_density_E3_E1             0.2286831
part_01_density_E2_E1             0.1496383
part_01_density_E3_E2             0.1761350
part_01_density_sqrt_E1           0.3287550
part_01_density_sqrt_E2           0.3197275
part_01_density_sqrt_E3           0.2734698
part_01_shape_Z_7_3               0.2757044
part_01_shape_Z_0_0               0.2802927
part_01_shape_Z_7_0               0.2028321
part_01_shape_Z_7_1               0.2458391
part_01_shape_Z_3_0               0.2201788
part_01_shape_Z_5_2               0.2548240
part_01_shape_Z_6_1               0.2545717
part_01_shape_Z_3_1               0.2356855
part_01_shape_Z_6_0               0.1798538
part_01_shape_Z_2_1               0.2552874
part_01_shape_Z_6_3               0.2906819
part_01_shape_Z_2_0               0.2535216
part_01_shape_Z_6_2               0.2856040
part_01_shape_Z_5_0               0.2090246
part_01_shape_Z_5_1               0.2443667
part_01_shape_Z_4_2               0.2801108
part_01_shape_Z_1_0               0.2052268
part_01_shape_Z_4_1               0.2748938
part_01_shape_Z_7_2               0.2663011
part_01_shape_Z_4_0               0.2027238
part_01_density_Z_7_3             0.2544970
part_01_density_Z_0_0             0.3124934
part_01_density_Z_7_0             0.2164337
part_01_density_Z_7_1             0.2265320
part_01_density_Z_3_0             0.1966747
part_01_density_Z_5_2             0.2459735
part_01_density_Z_6_1             0.2881872
part_01_density_Z_3_1             0.2304989
part_01_density_Z_6_0             0.2110675
part_01_density_Z_2_1             0.2845677
part_01_density_Z_6_3             0.2953989
part_01_density_Z_2_0             0.2973497
part_01_density_Z_6_2             0.2959463
part_01_density_Z_5_0             0.2083863
part_01_density_Z_5_1             0.2341277
part_01_density_Z_4_2             0.2648359
part_01_density_Z_1_0             0.2002108
part_01_density_Z_4_1             0.2586611
part_01_density_Z_7_2             0.2458349
part_01_density_Z_4_0             0.2328241
-------------------------------  ----------


Na tej podstawie do wyselekcjonowanych zostało 10 kolumn biorących udział w dalszych obliczeniach: part_01_shape_sqrt_E2, part_01_density_sqrt_E2, part_01_density_O5, part_01_density_O4, local_electrons, part_01_density_sqrt_E1, part_01_density_I2, part_01_shape_sqrt_E1, part_01_density_O3, part_01_density_I3.

Ze względu na duży rozrzut wartości res_name przy podziale zbioru wykorzystany został mechanizm stratyfikacji. W schemacie uczenia zastosowany został algorytm powtórzonej oceny krzyżowej (podział na 10 zbiorów). Model klasyfikacyjny został stworzony zgodnie z algorytmem Random Forest z doborem parametrów optymalizujących mtry na przedziale od 5 do 15. Z powodów wydajnościowych predykcję ograniczono tylko do 10 drzew decyzyjnych.


```
## Random Forest 
## 
## 283429 samples
##     10 predictor
##     50 classes: '1PE', 'ACT', 'ACY', 'ADP', 'ATP', 'BR', 'CA', 'CD', 'CL', 'CLA', 'COA', 'CU', 'DMS', 'EDO', 'EPE', 'FAD', 'FE', 'FE2', 'FMN', 'FMT', 'GDP', 'GOL', 'HEC', 'HEM', 'IOD', 'K', 'MAN', 'MES', 'MG', 'MLY', 'MN', 'MPD', 'NA', 'NAD', 'NAG', 'NAP', 'NDP', 'NI', 'NO3', 'PEG', 'PG4', 'PGE', 'PLP', 'PO4', 'SAH', 'SEP', 'SF4', 'SO4', 'TRS', 'ZN' 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold, repeated 1 times) 
## Summary of sample sizes: 255083, 255091, 255081, 255090, 255083, 255081, ... 
## Resampling results across tuning parameters:
## 
##   mtry  Accuracy   Kappa    
##    5    0.3419762  0.2867716
##    6    0.3430559  0.2880429
##    7    0.3443895  0.2894775
##    8    0.3437402  0.2888151
##    9    0.3434757  0.2885757
##   10    0.3437720  0.2889537
##   11    0.3429534  0.2880752
##   12    0.3426748  0.2876614
##   13    0.3434933  0.2886331
##   14    0.3435109  0.2886468
##   15    0.3427418  0.2878310
## 
## Accuracy was used to select the optimal model using the largest value.
## The final value used for the model was mtry = 7.
```

Jak widać trafność klasyfikacji nie jest wysoka. Z pewnością wykorzystanie większej ilości drzew decyzyjnych polepszyłoby rezultat. Poniżej przedstawiona została macierz predykcji.


```
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  1PE  ACT  ACY  ADP  ATP   BR   CA   CD   CL  CLA  COA   CU
##        1PE   22    8    1    2    2    0    5    0    4    3    5    0
##        ACT    5  131   25    4    4    8   40    4   63    7    3    1
##        ACY    1   17    5    0    0    0    0    3    8    1    2    1
##        ADP    3    4    0  346  113    0    6    1    3    3    9    1
##        ATP    1    2    0   59  135    1    6    0    2    5    3    0
##        BR     0    0    0    0    0   12   31    4   43    0    1    1
##        CA    10   47   14   12    3   73 1922   80  301   11    6   64
##        CD     1   16    5    0    1    1   17  195    6    1    0    5
##        CL     8   94   14    7    7  116  432   36 2503   14   10   20
##        CLA    9   11    1    8    7    1   11    1   13  138   12    1
##        COA    3    5    0    5    2    0    3    0    2    5   36    1
##        CU     0    2    1    0    0    2   15    7    0    1    1   51
##        DMS    4   45   10    0    2   10   58    6   71    4    5    7
##        EDO   92  372   68   27   15   35  161   13  434   79   71    9
##        EPE    1    3    0    2    0    1    9    0    7    1    6    0
##        FAD    0    0    0   13    8    1    6    1    2    6    6    0
##        FE     0    2    0    1    2    0    9    8    7    1    1    3
##        FE2    0    3    0    0    0    1   16    4    2    0    0    3
##        FMN    4    0    0    5    5    0    4    0    1    4    2    0
##        FMT    3   20    5    0    1    0    8    1   15    2    1    1
##        GDP    0    0    0   69   39    0    0    0    1    2    3    0
##        GOL  131  425   78   68   38   40  287   24  509  127   69   12
##        HEC    0    2    0    0    1    0    0    1    0    0    5    0
##        HEM    5   28    2   15   22    3   20    3   24   24   26    5
##        IOD    1   10    0    0    0   26   68   37   81    2    1    6
##        K      1    3    1    0    0    9   80    4  120    1    2    2
##        MAN    0    7    2   11    1    0    7    2    4   12    4    2
##        MES    3    3    2    5    3    0   18    1   15    1    4    1
##        MG    10   54   11    9    7    8  198   13  158   18    7    7
##        MLY    6   10    1    3    3    2    9    4    4    8   10    0
##        MN     0    4    3    5    2    3   49   21   10    0    0   21
##        MPD    1    9    2    0    1    0    5    0    7    4    2    1
##        NA     2   37    4    1    0   15   78    4  253    5    4    4
##        NAD    2    4    1   27    8    2    8    0    4   16   21    0
##        NAG  114   76   15  126   69    4  117    9   66  396   94    6
##        NAP    0    1    1   12   11    0    5    0    6    6   12    0
##        NDP    1    2    1    6    1    0    5    0    2    4    2    0
##        NI     0    2    0    1    0    1   10   10    2    0    0    1
##        NO3    0   13    0    0    0    0    4    0    3    0    1    0
##        PEG   13   14    2    2    0    3   10    0   14   10    4    0
##        PG4   21    7    0    1    3    0    4    0    7    7    8    0
##        PGE    8    5    0    1    1    1    2    1    3    1    0    1
##        PLP    0    2    0   12    2    0    6    0    2    0    3    0
##        PO4    3   27    2    7    7    7   79   16   48    3    6    2
##        SAH    1    1    2   30   13    0    1    1    0    3    8    0
##        SEP    2    1    0    3    2    0   13    1    2    1    1    1
##        SF4    0    1    0    0    4    0    4    8    2    0    0    0
##        SO4   36  439  107   31   19  111 1105  144  891   68   51   59
##        TRS    0    3    1    0    0    1    5    0    1    0    0    1
##        ZN     1   43   14   12    6   33  286  141   68   19   13  286
##           Reference
## Prediction  DMS  EDO  EPE  FAD   FE  FE2  FMN  FMT  GDP  GOL  HEC  HEM
##        1PE    1   24    6    3    0    1    1    2    0   35    0    4
##        ACT   47  167    9    6    3    4    3   25    1  173   10   31
##        ACY    3   21    2    3    1    1    0    4    0   14    0    1
##        ADP    0    9    4   22    2    1   14    1  107   16    1    7
##        ATP    0    2    0   11    1    0    6    2   38    7    1   13
##        BR     3    7    1    1    0    1    0    1    0   12    0    1
##        CA    58   73   14   10   43   48    5   16    2  131    2   42
##        CD     3    9    0    0   10   10    0    0    0    8    0    4
##        CL   107  354   14    5   23   15    2   43    0  386    2   39
##        CLA    5   37    2    6    1    1    7    1    6   79    2   23
##        COA    3   16   10    3    0    0    6    1    4   14    0   10
##        CU     0    2    0    0    6    2    1    0    1    0    0    0
##        DMS  113   89   10    0    4    4    2   16    0   62    4   12
##        EDO  148 2925   56   33   11   12   23  223   12 2276   32  190
##        EPE    0   10   64    2    1    0    0    2    3   19    0    2
##        FAD    3    8    0  631    1    3    9    1    8    8    1   19
##        FE     1    4    0    1   18    4    0    0    1    5    0    2
##        FE2    3    2    0    1    2   10    1    0    0    2    0    1
##        FMN    1    3    0   11    1    1  240    1    9    6    0    4
##        FMT   11   60    0    1    0    1    0   37    0   47    4    8
##        GDP    0    0    1    6    0    0    5    0   81    0    0    1
##        GOL  145 2166   52   67   16   28   28  151    9 4024   41  208
##        HEC    0    8    0    1    0    0    1    0    1    5   79   77
##        HEM   17   55    3   14    3    1    6    8    5   65  213 1574
##        IOD   24   20    4    0    6    9    0    1    0   23    2    4
##        K      6   19    0    0    3    2    0    2    0   22    0    1
##        MAN    2   15    1    5    0    0    0    1    0   23    0    4
##        MES    7   11   27   11    2    1    1    0    0   21    0    3
##        MG    18  124    5    4    7    6    2   23    2  227    4   26
##        MLY    5   25    7    8    1    3    5    3    1   39    2   12
##        MN     0    8    4    0   12   21    1    1    0   13    0    5
##        MPD    4   22    0    0    0    0    0    0    0   60    1    7
##        NA    19  163    3    2    4    2    2    8    1  174    1   19
##        NAD    4   13    2   38    1    1   12    1    7   18    1   12
##        NAG   26  295   32  130   19   12   67   26   49  621   18  104
##        NAP    3   10    1   18    0    1    4    0    3   14    2   11
##        NDP    0    7    0   20    1    0    3    0    0    4    1    6
##        NI     0    1    0    0    0    2    0    1    1    2    0    1
##        NO3    3   10    1    0    1    0    0    4    0    9    1    1
##        PEG    6   86    7    6    5    1    2   10    1  125    1   16
##        PG4    2   29    7    5    3    1    2    2    1   46    1    5
##        PGE    1   20    1    0    1    0    0    0    0   34    0    3
##        PLP    0    2    3    3    3    0    1    2    1    4    1    1
##        PO4   36   39    9    3   12   10    9    5    6   71    3   29
##        SAH    0    2    3    8    0    0    6    0   12    8    1    0
##        SEP    0    4    3    1    2    1    1    0    2    7    0    6
##        SF4    0    0    0    0    0    0    0    1    2    0    0    2
##        SO4  798  652   97   25   60   77   37   88   14 1052   40  183
##        TRS    1    4    2    1    2    1    0    1    0   20    0    1
##        ZN    19   31   13    9  108   90    3   11    5   55    5   47
##           Reference
## Prediction  IOD    K  MAN  MES   MG  MLY   MN  MPD   NA  NAD  NAG  NAP
##        1PE    0    2    6    1   12    4    1    3    4    4   39    1
##        ACT   11   11   11   17   46   12    7   13   41    7   50    7
##        ACY    3    2    0    2    7    1    6    2    8    1    4    1
##        ADP    1    4   12    1   12    3    4    1    1   50   60   13
##        ATP    1    1    1    1    7    1    2    0    1   12   34    8
##        BR    15    8    0    1    6    2    1    0   14    0    2    0
##        CA   175  189    8   19  229   14  134   11  101    7   72    7
##        CD    42    4    0    2    6    0   15    0    1    0    3    0
##        CL   212  292   10   31  339   16   40   20  532   13   73    9
##        CLA    0    6   23    4   20    5    2    5    7   13  167    8
##        COA    3    5    4    1    4    4    1    1    4   17   31    8
##        CU    18    2    0    0    3    0   10    0    0    0    3    1
##        DMS   41   13    1    8   20    6    4    9   23    3   13    6
##        EDO   70   66   68   54  287  100   30  132  328   86  469   58
##        EPE    5    7    3   15    2   10    2    2    4    4   15    1
##        FAD    0    0    3    3    1    2    2    1    0   31   47   40
##        FE     5    3    0    4    6    0    7    1    2    0    3    1
##        FE2    7    2    1    1    2    0    9    1    1    0    3    1
##        FMN    0    1    2    1    2    0    1    0    0    5   14   18
##        FMT    3    2    1    1   10    1    0    2    9    3    9    1
##        GDP    1    0    1    0    1    0    1    0    0    6   12    5
##        GOL   74   79  149   88  524  177   56  269  417  112  886   71
##        HEC    0    0    0    1    1    0    0    1    1    0    7    0
##        HEM    5    6   14    5   18    3    4    6    9   11   65   10
##        IOD  219   19    0    3   24    2    9    1   17    2    6    4
##        K     22   68    0    4   26    1    8    1   29    1   10    1
##        MAN    0    2   23    1   20    5    3    3    1    6   48    4
##        MES    4    5    2  112   15   10    8    5    5    8   19    2
##        MG    18   41   27   28  747   33   45   19  106    9  108   15
##        MLY    3    0    6   10   15  106    6   11    8    9   49    4
##        MN     7    4    2    3   18    3   75    3    7    2   21    1
##        MPD    3    0    3    2   10    8    3   18    2    3   17    1
##        NA    32   31    2    5   83    4    7   12  266    3   32    3
##        NAD    1    1    6    2    2    3    3    1    0  365   75   87
##        NAG    7   29  170   38  213  176   44   67   67  177 3283  122
##        NAP    0    0    0    2    2    1    1    2    2   45   40  221
##        NDP    0    0    1    0    2    0    1    1    0   11   18   45
##        NI     7    0    2    1    4    0   11    1    0    0    1    0
##        NO3    2    1    1    2    8    1    0    1    2    1    4    0
##        PEG    3    2    7    6    8    9    1    6   13    8   58    4
##        PG4    0    0    3    0    8    4    1    1    5    4   39    3
##        PGE    0    0    1    2    3    3    0    5    4    3   22    1
##        PLP    0    3    6   10    2    4    1    0    1   10    8    6
##        PO4   26   17    5   11   55    8   34    8   14    7   30    2
##        SAH    1    0    6    1    2    3    0    1    1   11   15    5
##        SEP    0    2    7    2   10    0    8    2    2    1   10    2
##        SF4    1    1    0    0    1    0    1    0    1    0    1    0
##        SO4  418  208   60  153  703  107  256  138  293   45  339   57
##        TRS    1    3    7    0   12    0    1    2    6    1   10    2
##        ZN   111   30    5   10   92   15  185   10   32    2   55    5
##           Reference
## Prediction  NDP   NI  NO3  PEG  PG4  PGE  PLP  PO4  SAH  SEP  SF4  SO4
##        1PE    0    0    2   19   22    9    0    7    2    2    0   20
##        ACT    5    3   25   22    9    5    0   38    1    3    0  204
##        ACY    0    0    1    3    0    1    0    2    0    1    1   20
##        ADP   10    1    0    3    1    1    5    6   20    4    0   14
##        ATP    4    0    0    1    0    0    3    8   17    5    4    4
##        BR     0    1    0    2    0    0    0    1    0    0    0   19
##        CA     5   45    6   11   10    7    8   87    4   16    3  563
##        CD     0   19    0    0    0    0    1    8    0    0    1   32
##        CL    11   10   16   33   14   13    1   93    5    5   12  551
##        CLA    6    2    2   16    7    5    2   13    3    4    0   38
##        COA    7    1    0    3    2    0    1    3    1    2    0   23
##        CU     0    2    2    0    0    0    0    2    0    0    1    4
##        DMS    4    5   16    8    6    3    0   44    0    3    0  305
##        EDO   36   12   52  293  136  108    7  153   19   16    0  754
##        EPE    0    1    0    5    1    2    2    1    3    2    0   31
##        FAD   28    0    0    4    2    3    1    3    6    1    0    9
##        FE     1    2    0    1    0    0    1    8    0    0    0   11
##        FE2    0    2    0    1    0    0    1    4    0    0    0   16
##        FMN   12    1    0    1    0    1    0    3    4    2    0    8
##        FMT    2    1    0    7    2    2    1    5    2    1    0   28
##        GDP    5    0    0    1    0    0    3    1    8    1    1    4
##        GOL   36    9   54  395  192  134   34  234   34   35    3 1123
##        HEC    1    0    0    2    0    0    1    0    0    1    0    7
##        HEM    5    2    3   11    7    3    6   30    5    2    4   78
##        IOD    0   11    3    2    3    2    1   17    0    0    1  122
##        K      1    4    3    2    1    0    0   13    1    1    2   53
##        MAN    2    0    1    4    4    3    0    4    1    2    1   22
##        MES    2    1    0    1    5    3    8   15    1    4    0   41
##        MG     2   11   10   23   11   11    5   83    3    9    3  406
##        MLY    6    0    1    7    8    2    5    5    4    5    0   46
##        MN     1   23    0    1    0    1    0   24    0    4    1   61
##        MPD    3    1    1    8    3    3    2    6    0    2    1   40
##        NA     1    2    6   19    5    6    2   12    1    2    1   95
##        NAD   37    2    1   10    3    2    1    5   13    1    0   13
##        NAG   85   14    9  131  124   74   42  114   64   79    1  408
##        NAP   93    0    1    2    1    2    2    4    2    0    0    8
##        NDP   54    0    1    2    0    1    4    3    0    1    0    8
##        NI     1    9    0    0    0    0    0    5    0    0    1   12
##        NO3    0    0   20    0    3    1    0    1    0    0    0   17
##        PEG    5    0    3   36   22    8    0    4    2    1    0   49
##        PG4    0    1    1   13   25    9    0    4    1    0    0   12
##        PGE    0    0    2   16    6   10    0    5    1    0    0   10
##        PLP    4    0    0    0    1    0  190    3    5    2    2   10
##        PO4    1   10   12    7    1    3   13  173    1   11    3  481
##        SAH    1    0    0    1    0    0    1    1  144    1    0    3
##        SEP    1    1    1    1    2    1    1   18    6   68    0   12
##        SF4    0    2    0    1    0    0    0    3    0    0  357    1
##        SO4   39  102  138  102   46   32   38 1429   10   50    3 8094
##        TRS    0    0    0    1    0    0    0    4    0    0    0    8
##        ZN     6   95    4    2    0    2    3   56    1   20    4  211
##           Reference
## Prediction  TRS   ZN
##        1PE    0    5
##        ACT    5   43
##        ACY    2    4
##        ADP    0   10
##        ATP    0    4
##        BR     0    8
##        CA     8  428
##        CD     2   71
##        CL    13  142
##        CLA    2   13
##        COA    1    5
##        CU     0   76
##        DMS    3   28
##        EDO   35   73
##        EPE    1    9
##        FAD    1    3
##        FE     2   21
##        FE2    0   25
##        FMN    0    1
##        FMT    0    9
##        GDP    0    3
##        GOL  120  187
##        HEC    2    4
##        HEM    5   22
##        IOD    0   47
##        K      2   23
##        MAN    4    7
##        MES    3    6
##        MG    50  123
##        MLY    3   13
##        MN     2   93
##        MPD    2    5
##        NA     3   22
##        NAD    1    7
##        NAG   28  160
##        NAP    0    2
##        NDP    1    0
##        NI     0   26
##        NO3    0    3
##        PEG    2    8
##        PG4    1    3
##        PGE    0    3
##        PLP    0    9
##        PO4    6   83
##        SAH    1    0
##        SEP    0   22
##        SF4    1    5
##        SO4   46  582
##        TRS   39    3
##        ZN    13 2490
## 
## Overall Statistics
##                                           
##                Accuracy : 0.3441          
##                  95% CI : (0.3411, 0.3472)
##     No Information Rate : 0.1494          
##     P-Value [Acc > NIR] : < 2.2e-16       
##                                           
##                   Kappa : 0.2894          
##  Mcnemar's Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: 1PE Class: ACT Class: ACY Class: ADP
## Sensitivity           0.0415879   0.065012  1.247e-02   0.364979
## Specificity           0.9971040   0.986596  9.984e-01   0.993968
## Pos Pred Value        0.0748299   0.095620  3.125e-02   0.380220
## Neg Pred Value        0.9946154   0.979760  9.958e-01   0.993564
## Prevalence            0.0056008   0.021334  4.246e-03   0.010037
## Detection Rate        0.0002329   0.001387  5.294e-05   0.003663
## Detection Prevalence  0.0031127   0.014505  1.694e-03   0.009635
## Balanced Accuracy     0.5193459   0.525804  5.054e-01   0.679474
##                      Class: ATP Class: BR Class: CA Class: CD Class: CL
## Sensitivity            0.236842 0.0225989   0.36665  0.241038   0.43200
## Specificity            0.997028 0.9980089   0.96377  0.996754   0.95202
## Pos Pred Value         0.326087 0.0603015   0.37291  0.390782   0.37043
## Neg Pred Value         0.995374 0.9944935   0.96282  0.993465   0.96247
## Prevalence             0.006035 0.0056220   0.05550  0.008565   0.06134
## Detection Rate         0.001429 0.0001271   0.02035  0.002065   0.02650
## Detection Prevalence   0.004383 0.0021069   0.05457  0.005283   0.07154
## Balanced Accuracy      0.616935 0.5103039   0.66521  0.618896   0.69201
##                      Class: CLA Class: COA Class: CU Class: DMS Class: EDO
## Sensitivity            0.134766  0.0665434  0.086882   0.068237    0.38170
## Specificity            0.993385  0.9976041  0.998242   0.989256    0.90973
## Pos Pred Value         0.182540  0.1379310  0.236111   0.101802    0.27187
## Neg Pred Value         0.990544  0.9946385  0.994312   0.983469    0.94339
## Prevalence             0.010842  0.0057278  0.006215   0.017533    0.08113
## Detection Rate         0.001461  0.0003812  0.000540   0.001196    0.03097
## Detection Prevalence   0.008004  0.0027633  0.002287   0.011752    0.11391
## Balanced Accuracy      0.564075  0.5320738  0.542562   0.528746    0.64572
##                      Class: EPE Class: FAD Class: FE Class: FE2 Class: FMN
## Sensitivity           0.1333333   0.555947 0.0450000  0.0257069   0.463320
## Specificity           0.9979036   0.996839 0.9986071  0.9987455   0.998520
## Pos Pred Value        0.2452107   0.681425 0.1208054  0.0781250   0.633245
## Neg Pred Value        0.9955834   0.994611 0.9959492  0.9959819   0.997045
## Prevalence            0.0050820   0.012017 0.0042350  0.0041185   0.005484
## Detection Rate        0.0006776   0.006681 0.0001906  0.0001059   0.002541
## Detection Prevalence  0.0027633   0.009804 0.0015775  0.0013552   0.004013
## Balanced Accuracy     0.5656185   0.776393 0.5218036  0.5122262   0.730920
##                      Class: FMT Class: GDP Class: GOL Class: HEC
## Sensitivity           0.0509642  0.2045455     0.3990  0.1656184
## Specificity           0.9968952  0.9980756     0.8790  0.9986060
## Pos Pred Value        0.1128049  0.3091603     0.2827  0.3761905
## Neg Pred Value        0.9926798  0.9966557     0.9244  0.9957768
## Prevalence            0.0076865  0.0041927     0.1068  0.0050502
## Detection Rate        0.0003917  0.0008576     0.0426  0.0008364
## Detection Prevalence  0.0034727  0.0027739     0.1507  0.0022234
## Balanced Accuracy     0.5239297  0.6013105     0.6390  0.5821122
##                      Class: HEM Class: IOD Class: K Class: MAN Class: MES
## Sensitivity             0.56578   0.138783 0.058020  0.0343284   0.167414
## Specificity             0.99012   0.993313 0.994779  0.9973236   0.996662
## Pos Pred Value          0.63468   0.260714 0.122523  0.0839416   0.263529
## Neg Pred Value          0.98687   0.985482 0.988242  0.9931300   0.994076
## Prevalence              0.02945   0.016707 0.012409  0.0070936   0.007083
## Detection Rate          0.01666   0.002319 0.000720  0.0002435   0.001186
## Detection Prevalence    0.02626   0.008894 0.005876  0.0029010   0.004500
## Balanced Accuracy       0.77795   0.566048 0.526400  0.5158260   0.582038
##                      Class: MG Class: MLY Class: MN Class: MPD Class: NA
## Sensitivity           0.204658   0.122261 0.0713606  0.0225282  0.111204
## Specificity           0.976355   0.995758 0.9950214  0.9972772  0.987008
## Pos Pred Value        0.258120   0.210736 0.1388889  0.0659341  0.181943
## Neg Pred Value        0.968293   0.991900 0.9896072  0.9917072  0.977137
## Prevalence            0.038644   0.009179 0.0111275  0.0084594  0.025325
## Detection Rate        0.007909   0.001122 0.0007941  0.0001906  0.002816
## Detection Prevalence  0.030640   0.005326 0.0057173  0.0028904  0.015479
## Balanced Accuracy     0.590506   0.559009 0.5331910  0.5099027  0.549106
##                      Class: NAD Class: NAG Class: NAP Class: NDP Class: NI
## Sensitivity            0.326184    0.51305   0.253440  0.1032505 2.206e-02
## Specificity            0.994857    0.94396   0.996442  0.9982327 9.989e-01
## Pos Pred Value         0.431953    0.39954   0.398917  0.2454545 7.759e-02
## Neg Pred Value         0.991945    0.96387   0.993067  0.9950229 9.958e-01
## Prevalence             0.011847    0.06775   0.009232  0.0055373 4.320e-03
## Detection Rate         0.003864    0.03476   0.002340  0.0005717 9.529e-05
## Detection Prevalence   0.008946    0.08700   0.005865  0.0023293 1.228e-03
## Balanced Accuracy      0.660521    0.72851   0.624941  0.5507416 5.105e-01
##                      Class: NO3 Class: PEG Class: PG4 Class: PGE
## Sensitivity           0.0503778  0.0291734  0.0364964  0.0211416
## Specificity           0.9989474  0.9939174  0.9970672  0.9981804
## Pos Pred Value        0.1680672  0.0597015  0.0833333  0.0552486
## Neg Pred Value        0.9960035  0.9872347  0.9929900  0.9950886
## Prevalence            0.0042032  0.0130650  0.0072524  0.0050079
## Detection Rate        0.0002118  0.0003812  0.0002647  0.0001059
## Detection Prevalence  0.0012599  0.0063843  0.0031763  0.0019163
## Balanced Accuracy     0.5246626  0.5115454  0.5167818  0.5096610
##                      Class: PLP Class: PO4 Class: SAH Class: SEP
## Sensitivity            0.479798   0.062568   0.364557   0.184282
## Specificity            0.998565   0.985952   0.998352   0.998236
## Pos Pred Value         0.584615   0.118412   0.481605   0.290598
## Neg Pred Value         0.997811   0.972126   0.997334   0.996805
## Prevalence             0.004193   0.029274   0.004182   0.003907
## Detection Rate         0.002012   0.001832   0.001525   0.000720
## Detection Prevalence   0.003441   0.015468   0.003166   0.002477
## Balanced Accuracy      0.739181   0.524260   0.681455   0.591259
##                      Class: SF4 Class: SO4 Class: TRS Class: ZN
## Sensitivity            0.868613     0.5737  0.0951220   0.50415
## Specificity            0.999543     0.8559  0.9988728   0.97445
## Pos Pred Value         0.892500     0.4114  0.2689655   0.52125
## Neg Pred Value         0.999426     0.9196  0.9960660   0.97269
## Prevalence             0.004351     0.1494  0.0043409   0.05229
## Detection Rate         0.003780     0.0857  0.0004129   0.02636
## Detection Prevalence   0.004235     0.2083  0.0015352   0.05058
## Balanced Accuracy      0.934078     0.7148  0.5469974   0.73930
```
